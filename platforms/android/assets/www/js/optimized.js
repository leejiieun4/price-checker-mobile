/**
 * almond 0.2.7 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*
    pO\
   6  /\
     /OO\
    /OOOO\
  /OOOOOOOO\
 ((OOOOOOOO))
  \:~=++=~:/

ChocolateChip-UI
ChocolateChip.js
Copyright 2013 Sourcebits www.sourcebits.com
License: BSD
Version: 3.0.7
*/

/*
    pO\
   6  /\
     /OO\
    /OOOO\
  /OOOOOOOO\
 ((OOOOOOOO))
  \:~=++=~:/

ChocolateChip-UI
ChUI.js
Copyright 2013 Sourcebits www.sourcebits.com
License: BSD
Version: 3.0.7
*/

/**
 * @preserve FastClick: polyfill to remove click delays on browsers with touch UIs.
 *
 * @version 0.6.9
 * @codingstandard ftlabs-jsv2
 * @copyright The Financial Times Limited [All Rights Reserved]
 * @license MIT License (see LICENSE.txt)
 */

/**
 * @license RequireJS text 2.0.10 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

(function(){function r(e){var t,n=this;this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=10,this.layer=e;if(!e||!e.nodeType)throw new TypeError("Layer must be a document node");this.onClick=function(){return r.prototype.onClick.apply(n,arguments)},this.onMouse=function(){return r.prototype.onMouse.apply(n,arguments)},this.onTouchStart=function(){return r.prototype.onTouchStart.apply(n,arguments)},this.onTouchMove=function(){return r.prototype.onTouchMove.apply(n,arguments)},this.onTouchEnd=function(){return r.prototype.onTouchEnd.apply(n,arguments)},this.onTouchCancel=function(){return r.prototype.onTouchCancel.apply(n,arguments)};if(r.notNeeded(e))return;this.deviceIsAndroid&&(e.addEventListener("mouseover",this.onMouse,!0),e.addEventListener("mousedown",this.onMouse,!0),e.addEventListener("mouseup",this.onMouse,!0)),e.addEventListener("click",this.onClick,!0),e.addEventListener("touchstart",this.onTouchStart,!1),e.addEventListener("touchmove",this.onTouchMove,!1),e.addEventListener("touchend",this.onTouchEnd,!1),e.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(e.removeEventListener=function(t,n,r){var i=Node.prototype.removeEventListener;t==="click"?i.call(e,t,n.hijacked||n,r):i.call(e,t,n,r)},e.addEventListener=function(t,n,r){var i=Node.prototype.addEventListener;t==="click"?i.call(e,t,n.hijacked||(n.hijacked=function(e){e.propagationStopped||n(e)}),r):i.call(e,t,n,r)}),typeof e.onclick=="function"&&(t=e.onclick,e.addEventListener("click",function(e){t(e)},!1),e.onclick=null)}var e,t,n;(function(r){function d(e,t){return h.call(e,t)}function v(e,t){var n,r,i,s,o,u,a,f,c,h,p=t&&t.split("/"),d=l.map,v=d&&d["*"]||{};if(e&&e.charAt(0)===".")if(t){p=p.slice(0,p.length-1),e=p.concat(e.split("/"));for(f=0;f<e.length;f+=1){h=e[f];if(h===".")e.splice(f,1),f-=1;else if(h===".."){if(f===1&&(e[2]===".."||e[0]===".."))break;f>0&&(e.splice(f-1,2),f-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((p||v)&&d){n=e.split("/");for(f=n.length;f>0;f-=1){r=n.slice(0,f).join("/");if(p)for(c=p.length;c>0;c-=1){i=d[p.slice(0,c).join("/")];if(i){i=i[r];if(i){s=i,o=f;break}}}if(s)break;!u&&v&&v[r]&&(u=v[r],a=f)}!s&&u&&(s=u,o=a),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function m(e,t){return function(){return s.apply(r,p.call(arguments,0).concat([e,t]))}}function g(e){return function(t){return v(t,e)}}function y(e){return function(t){a[e]=t}}function b(e){if(d(f,e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!d(a,e)&&!d(c,e))throw new Error("No "+e);return a[e]}function w(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function E(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice;o=function(e,t){var n,r=w(e),i=r[0];return e=r[1],i&&(i=v(i,t),n=b(i)),i?n&&n.normalize?e=n.normalize(e,g(t)):e=v(e,t):(e=v(e,t),r=w(e),i=r[0],e=r[1],i&&(n=b(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return m(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:E(e)}}},i=function(e,t,n,i){var s,l,h,p,v,g=[],w=typeof n,E;i=i||e;if(w==="undefined"||w==="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(v=0;v<t.length;v+=1){p=o(t[v],i),l=p.f;if(l==="require")g[v]=u.require(e);else if(l==="exports")g[v]=u.exports(e),E=!0;else if(l==="module")s=g[v]=u.module(e);else if(d(a,l)||d(f,l)||d(c,l))g[v]=b(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,m(i,!0),y(l),{}),g[v]=a[l]}}h=n?n.apply(a[e],g):undefined;if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!E)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){return typeof e=="string"?u[e]?u[e](t):b(o(e,t).f):(e.splice||(l=e,t.splice?(e=t,t=n,n=null):e=r),t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},4),s)},s.config=function(e){return l=e,l.deps&&s(l.deps,l.callback),s},e._defined=a,n=function(e,t,n){t.splice||(n=t,t=[]),!d(a,e)&&!d(f,e)&&(f[e]=[e,t,n])},n.amd={jQuery:!0}})(),n("bower_components/almond/almond.js",function(){}),function(){var e=function(e){return typeof e=="string"?[]:e&&e.length&&e[0]===undefined?[]:e&&e.length?e:[]},t=function(e,n){var r=/^#([\w-]*)$/,i=/^\.([\w-]+)$/,s=/^[\w-]+$/,o=function(e){var t=document.getElementById(e.split("#")[1]);return t?[t]:[]},u=function(e,t){return t?[].slice.apply(t.getElementsByTagName(e)):[].slice.apply(document.getElementsByTagName(e))},a=function(e,t){return t?[].slice.apply(t.getElementsByClassName(e.split(".")[1])):[].slice.apply(document.getElementsByClassName(e.split(".")[1]))},f=function(e,t){return typeof e=="string"&&(e=e.trim()),typeof e=="string"&&r.test(e)?o(e):e&&e instanceof Array&&e.length?e:!t&&typeof e=="string"?s.test(e)?u(e):i.test(e)?a(e):[].slice.apply(document.querySelectorAll(e)):t?[].slice.apply(t.querySelectorAll(e)):[].slice.apply(document.querySelectorAll(e))};if(typeof e=="undefined"||e===document)return[document];if(e===null)return[];if(!n)if(typeof e=="function")t.ready(function(){return e.call(e)});else{if(e&&e.nodeType===1)return[e];if(typeof e=="string"){if(e==="")return[];if(/<\/?[^>]+>/.test(e))return t.make(e);try{return f(e)?f(e):[]}catch(l){return[]}}else{if(e instanceof Array)return e;if(/NodeListConstructor/i.test(e.constructor.toString()))return[].slice.apply(e);if(e===window)return[]}}else{if(typeof n=="string")return[].slice.apply(document.querySelectorAll(n+" "+e));if(n.nodeType===1)return f(e,n)}return this};t.extend=function(e,n,r){return r=r||!1,n||(n=e,e=t),Object.keys(n).forEach(function(t){n.hasOwnProperty(t)&&Object.defineProperty(e,t,{value:n[t],writable:!0,enumerable:r,configurable:!0})}),this},t.extend({version:"3.0.5",libraryName:"ChocolateChip",slice:Array.prototype.slice,make:function(e){var n=[],r=document.createElement("div");return r.innerHTML=e,r=t.slice.apply(r.childNodes),r.forEach(function(e){e.nodeType===1?n.push(e):e.nodeType===3&&e.nodeValue.trim().length!==0&&n.push(e)}),n},html:function(e){return this.make(e)},replace:function(e,t){if(!e||!t)return;e=e.length?e[0]:e,t=t.length?t[0]:t,t.parentNode.replaceChild(e,t);return},require:function(e,n){n=n||t.noop;var r=document.createElement("script");r.setAttribute("type","text/javascript"),r.setAttribute("src",e),r.onload=r.onreadystatechange=function(){(!r.readyState||r.readyState==="complete")&&n.apply(n,arguments)},t("head").insert(r,"last")},processJSON:function(e,n){n!==null||n!==undefined?n="var "+n+" = ":n="var data = ";var r=document.createElement("script");r.setAttribute("type","text/javascript");var i="_"+t.uuidNum();r.setAttribute("id",i),r.html(n+e),t("head").append(r),t.defer(function(){var e="#"+i;t(e).remove()})},delay:function(e,n){e=e||t.noop,setTimeout(function(){e.call(e)},n)},defer:function(e){return e=e||t.noop,t.delay.apply(t,[e,1].concat(t.slice.call(arguments,1)))},noop:function(){},concat:function(e){if(e instanceof Array)return e.join("");if(e instanceof Object)return;return e=t.slice.apply(arguments),String.prototype.concat.apply(e.join(""))},w:function(e){return e.split(" ")},isString:function(e){return typeof e=="string"},isArray:function(e){return Array.isArray(e)},isFunction:function(e){return Object.prototype.toString.call(e)==="[object Function]"},isObject:function(e){return Object.prototype.toString.call(e)==="[object Object]"},isNumber:function(e){return typeof e=="number"},isInteger:function(e){return typeof e=="number"&&e%1===0},isFloat:function(e){return typeof e=="number"&&e%1!==0},uuidNum:function(){return Math.floor((1+Math.random())*4294967296)},makeUuid:function(){return t.concat("chch_",t.uuid)},uuid:0,chch_cache:{},fn:{}}),t.fn.extend=function(e){return t.extend(Array.prototype,e)},t.uuid=t.uuidNum(),t.chch_cache.data={},t.chch_cache.events={},t.extend(t.chch_cache.events,{keys:[],values:[],set:function(e,n,r,i){var s,o=this.values.length>0?this.values.length-1:0,u;e.id?s=e.id:(++t.uuid,s=t.makeUuid(),e.setAttribute("id",s)),this.keys.indexOf(s)>=0?(this.values[o].push([]),u=this.values[o],u.push(n),u.push(r),u.push(i),e.addEventListener(n,r,i)):(this.keys.push(s),this.values.push([]),o=this.values.length-1,this.values[o].push([]),u=this.values[o],u[0].push(n),u[0].push(r),u[0].push(i),e.addEventListener(n,r,i))},hasKey:function(e){return this.keys.indexOf(e)>=0?!0:!1},_delete:function(e,n,r){var i=this,s=this.keys.indexOf(e),o=this.values;if(!e)return;typeof n=="undefined"&&(o[s].each(function(n){document.getElementById(e).removeEventListener(n[0],n[1],n[2]),t.chch_cache.events.keys.splice(s,1),o[s].splice(s,1)}),o.splice(s,1)),n&&r&&o[s].each(function(r){r[0]===n&&(document.getElementById(e).removeEventListener(r[0],r[1],r[2]),t.chch_cache.events.values.splice(s,1),t.chch_cache.events.keys.splice(s,1))}),n&&typeof r=="undefined"&&i.values[s].each(function(r){r[0]===n&&(document.getElementById(e).removeEventListener(r[0],r[1],r[2]),t.chch_cache.events.values.splice(s,1),t.chch_cache.events.keys.splice(s,1))})}}),t.fn.extend({each:function(e,t){if(!this.length)return[];if(typeof e!="function")return;var n,r=this.length;t=arguments[1];for(n=0;n<r;n++)n in this&&this.hasOwnProperty(n)&&e.call(t,this[n],n,this);return this},unique:function(){var e=[],t=this.sort();return t.forEach(function(t,n){e.indexOf(t)===-1&&e.push(t)}),e.length?e:[]},eq:function(e){return this.length?(e=parseInt(e,10),this.length<e+1?[]:e<0?this[this.length+e]?[this[this.length+e]]:[]:e!==0&&!e?[]:[this[e]]):[]},index:function(e){if(!this.length)return[];var n;return e?e instanceof Array?this.indexOf(e[0]):e.nodeType===1?this.indexOf(e):this.indexOf(e):(n=t(this[0]),n.parent().children().indexOf(n[0]))},is:function(e){if(!this.length||!e)return[];if(!this.length)return[];var n=[],r,i=function(e,n){r=this;if(typeof n=="string"){if([].slice.apply(e.parentNode.querySelectorAll(n)).indexOf(e)>=0)return e}else if(typeof n=="function"){if(n.call(r))return e}else if(n&&n.length){if(t.slice.apply(n).indexOf(e)!==-1)return e}else{if(n.nodeType!==1)return[];if(e===n)return e}};return this.each(function(t){i(t,e)&&n.push(t)}),n.length?n:[]},isnt:function(e){if(!this.length)return[];var n=[],r,i=function(e,n){r=this;if(typeof n=="string"){if([].slice.apply(e.parentNode.querySelectorAll(n)).indexOf(e)===-1)return e}else if(typeof n=="function"){if(n.call(r))return e}else if(n.length){if(t.slice.apply(n).indexOf(e)===-1)return e}else{if(n.nodeType!==1)return[];if(e!==n)return e}};return this.each(function(t){i(t,e)&&n.push(t)}),n.length?n:[]},has:function(e){if(!this.length)return[];var n=[],r=function(e,n){if(typeof n=="string"){if(e.querySelector(n))return e}else{if(n.nodeType!==1)return!1;if(t.slice.apply(this.children).indexOf(n))return e}};return this.each(function(t){r(t,e)&&n.push(t)}),n.length?n:[]},hasnt:function(e){if(!this.length)return[];var n=[];return this.each(function(r){typeof e=="string"?r.querySelector(e)||n.push(r):e.nodeType===1&&(t.slice.apply(r.children).indexOf(e)||n.push(r))}),n.length?n:[]},find:function(e,n){var r=[];return this.length?(n?n.each(function(){t.slice.apply(n.querySelectorAll(e)).each(function(e){r.push(e)})}):this.each(function(n){t.slice.apply(n.querySelectorAll(e)).each(function(e){r.push(e)})}),r):r},css:function(e,n){if(!this.length)return[];var r=[];if(!e)return[];if(!n&&e instanceof Object){if(!this.length)return;this.each(function(n){for(var i in e)e.hasOwnProperty(i)&&(n.style[t.camelize(i)]=e[i]);r.push(n)})}else{if(!n&&typeof e=="string"){if(!this.length)return;return document.defaultView.getComputedStyle(this[0],null).getPropertyValue(e.toLowerCase())}if(!!n){if(!this.length)return[];this.each(function(i){i.style[t.camelize(e)]=n,r.push(i)})}}return r.length?r:[]},width:function(){if(!this.length)return;return this.eq(0)[0].clientWidth},height:function(){if(!this.length)return;return this.eq(0)[0].clientHeight},offset:function(){if(!this.length)return;var e=this.eq(0)[0].getBoundingClientRect();return{top:Math.round(e.top),left:Math.round(e.left),bottom:Math.round(e.bottom),right:Math.round(e.right)}},prependTo:function(e){return this.length?(this.reverse(),this.each(function(n){t(e)[0].insertBefore(n,t(e)[0].firstChild)}),this):[]},appendTo:function(e){return this.length?(this.each(function(n){t(e).append(n)}),this):[]},before:function(e){if(!this.length)return[];var n=function(e,n){typeof n=="string"&&(n=t.make(n));if(n&&n.constructor===Array){var r=n.length,i=0;while(i<r)e.insertAdjacentElement("beforeBegin",n[i]),i++}else n&&n.nodeType===1&&e.insertAdjacentElement("beforeBegin",n);return e};return this.each(function(t){n(t,e)}),this},after:function(e){if(!this.length)return[];var n=function(e,n){var r=e.parentNode;typeof n=="string"&&(n=t.make(n));if(n&&n.constructor===Array){var i=0,s=n.length;while(i<s)e===r.lastChild?r.appendChild(n[i]):r.insertBefore(n[i],e.nextSibling),i++}else n&&n.nodeType===1&&r.appendChild(n);return this};return this.each(function(t){n(t,e)}),this},text:function(e){if(!this.length)return[];var t="",n=function(e,t){return!t&&t!==0?e.innerText:(e.innerText=t,e)};return this.each(function(r){e?n(r,e):t+=n(r)}),e?this:t},insert:function(e,n){if(!this.length)return[];var r=function(e,n,r){e instanceof Array&&(e=e[0]);var i=[];typeof n=="string"?i=t.make(n):n&&n.nodeType===1?i.push(n):n instanceof Array&&(i=n);var s=0,o=i.length;if(!r||r>e.children.length+1||r==="last")while(s<o)e.appendChild(i[s]),s++;else if(r===1||r==="first"){if(e.children)if(e.firstElementChild)while(s<o)e.insertBefore(i[s],e.firstChild),s++;else while(s<o)e.insertBefore(i[s],e.firstChild),s++}else while(s<o)e.insertBefore(i[s],e.childNodes[r]),s++;return e},i=e;return typeof i=="string"?this.each(function(t){r(t,e,n)}):i instanceof Array?this.each(function(e,t){if(n===1||n==="first")i=i.reverse();i.each(function(t,i){r(e,t,n)})}):i.nodeType===1&&this.each(function(e){r(e,i,n)}),this},html:function(e){if(!this.length)return[];var t=[],n=function(e,n){n===""?(e.innerHTML="",t.push(e)):n?(e.innerHTML=n,t.push(e)):n||(t=e.innerHTML)};return this.each(function(t){n(t,e)}),t.length?t:[]},prepend:function(e){return this.length?(this.insert(e,"first"),this):[]},append:function(e){return this.length?(this.insert(e,"last"),this):[]},attr:function(e,t){if(!this.length)return[];var n=[],r=function(e,t,n){return n?e.setAttribute(t,n):e.getAttribute(t)};if(!t){if(this[0].hasAttribute(e))return this[0].getAttribute(e)}else this.each(function(i){r(i,e,t),n.push(i)});if(n.length)return n},prop:function(e,t){return this.length?this.attr(e,t):[]},hasAttr:function(t){if(!this.length)return[];var n=[];return this.each(function(e){e.hasAttribute(t)&&n.push(e)}),e(n)},removeAttr:function(t){if(!this.length)return[];var n=[];return this.each(function(e){!e.hasAttribute(t)||(e.removeAttribute(t),n.push(e))}),e(n)},hasClass:function(t){if(!this.length)return[];var n=[],r=[];return/\s/.test(t)&&(r=t.split(" ")),this.each(function(e){r.length?(r.forEach(function(t){e&&e.classList&&e.classList.contains(t)&&n.push(e)}),n=n.unique()):e&&e.classList&&e.classList.contains(t)&&n.push(e)}),e(n)},addClass:function(t){if(!this.length)return[];var n=[],r;return this.each(function(e){/\s/.test(t)?(r=t.split(" "),r.each(function(t){e.classList.add(t)})):e.classList.add(t),n.push(e)}),e(n)},removeClass:function(t){if(!this.length)return[];var n=[],r;return this.each(function(e){if(!e)return;/\s/.test(t)?(r=t.split(" "),r.each(function(t){e.classList.remove(t)})):e.classList.remove(t),e.getAttribute("class")===""&&e.removeAttribute("class"),n.push(e)}),e(n)},toggleClass:function(t){if(!this.length)return[];var n=[];return this.each(function(e){e.classList.toggle(t),n.push(e)}),e(n)},dataset:function(n,r){if(!this.length)return[];var i=[];return typeof r=="string"&&r.length>=0?(this.each(function(e){e.dataset[n]=r,i.push(e)}),e(i)):this[0].dataset[t.camelize(n)]},val:function(e){if(!this.length)return[];if(typeof e=="string")return this[0].value=e,this;if(this[0]&&this[0].value)return this[0].value;return},disable:function(){if(!this.length)return[];var t=[];return this.each(function(e){e.classList.add("disabled"),e.setAttribute("disabled",!0),e.style.cursor="default"}),e(t)},enable:function(){if(!this.length)return[];var t=[];return this.each(function(e){e.classList.remove("disabled"),e.removeAttribute("disabled"),e.style.cursor="auto"}),e(t)},hide:function(n,r){if(!this.length)return[];var i=r||t.noop;if(!this.length)return[];var s=[],o="",u={},a={opacity:0,height:0,padding:0},f=t.isWebkit?"-webkit-transition":"transition";return this.each(function(e){u.padding=t(e).css("padding"),u.height=t(e).css("height"),u.opacity=t(e).css("opacity"),u.display=t(e).css("display"),t(e).data("ui-dimensions",u),typeof n=="string"?n==="slow"?(t(e).css({transition:"all 1s ease-out"}),t(e).css(a),setTimeout(function(){t(e).css({visibility:"hidden",display:"none"}),i.apply(e,arguments)},1e3)):n==="fast"&&(t(e).css({transition:"all .35s ease-in-out"}),t(e).css(a),setTimeout(function(){t(e).css({visibility:"hidden",display:"none"}),i.apply(e,arguments)},350)):typeof n=="number"&&(o="all "+n+"ms ease-in-out",t(e).css({transition:o}),t(e).css(a),setTimeout(function(){t(e).css({visibility:"hidden",display:"none"}),i.apply(e,arguments)},n)),!r&&typeof n=="function"&&(t(e).css({display:"none",visibility:"hidden"}),n.apply(e,arguments)),n||(t(e).data("",""),t(e).css({display:"none",visibility:"hidden"})),s.push(e)}),e(s)},show:function(e,n){if(!this.length)return[];var r=n||t.noop,i=function(e,t,n){return{opacity:e,height:t,padding:n}},s=t.isWebkit?"-webkit-transition":"transition";this.each(function(n){var s=t(n).data("ui-dimensions"),o=s&&s.height||"auto",u=s&&s.padding||"auto",a=s&&s.opacity||1,f=s&&s.display||"block";typeof e=="string"?e==="slow"?(t(n).css({visibility:"visible",display:f}),setTimeout(function(){t(n).css({transition:"all 1s ease-out"}),t(n).css(i(a,o,u)),setTimeout(function(){r.apply(n,arguments)},1e3)})):e==="fast"&&(t(n).css({visibility:"visible",display:f}),setTimeout(function(){t(n).css({transition:"all .250s ease-out"}),t(n).css(i(a,o,u)),setTimeout(function(){r.apply(n,arguments)},250)})):typeof e=="number"&&(t(n).css({visibility:"visible",display:f}),setTimeout(function(){t(n).css({transition:"all "+e+"ms ease-out"}),t(n).css(i(a,o,u)),setTimeout(function(){r.apply(n,arguments)},e)})),e||t(n).css({display:f,visibility:"visible",opacity:a})})},prev:function(){if(!this.length)return[];var e=[];return this.each(function(t){t.previousElementSibling&&e.push(t.previousElementSibling)}),e},next:function(){if(!this.length)return[];var e=[];return this.each(function(t){t.nextElementSibling&&e.push(t.nextElementSibling)}),e},first:function(){if(!this.length)return[];var e=[];return this.each(function(t){t.firstElementChild&&e.push(t.firstElementChild)}),e},last:function(){if(!this.length)return[];var e=[];return this.each(function(t){t.lastElementChild&&e.push(t.lastElementChild)}),e},children:function(e){if(!this.length)return[];var t=[];return e?this.forEach(function(n){[].slice.apply(n.children).forEach(function(n){[n].is(e)[0]&&t.push(n)})}):this.each(function(e){[].slice.apply(e.children).forEach(function(e){t.push(e)})}),t},parent:function(){if(!this.length)return[];var t=[];return this.each(function(e){t.push(e.parentNode)}),t=t.unique(),e(t)},ancestor:function(n){if(!this.length)return[];var r=[];return this.each(function(e){if(typeof n=="undefined")return[];var i=null,s=null,o=e.parentNode;if(!o)return[];typeof n=="string"&&n.trim();if(typeof n=="number"){i=n||1;for(var u=1;u<i;u++){if(o.nodeName==="HTML")return o;o!==null&&(o=o.parentNode)}r.push(o)}else typeof n=="string"&&n.substr(0,1)==="."?(s=n.split(".")[1],o.nodeName==="BODY"&&r.push(o),o.classList.contains(s)?r.push(o):r.push(t(o).ancestor(n)[0])):typeof n=="string"&&n.substr(0,1)==="#"?(s=n.split("#")[1],o.getAttribute("id")===s?r.push(o):r.push(t(o).ancestor(n)[0])):o.tagName&&o.tagName.toLowerCase()===n?r.push(o):r.push(t(o).ancestor(n)[0])}),r=r.unique(),r[0]===undefined?[]:e(r)},closest:function(e){if(!this.length)return[];var n=[];return this.each(function(r){n.push(t(r).ancestor(e)[0])}),n.length?n:this},siblings:function(e){if(!this.length)return[];var n,r=[];return e&&typeof e=="string"?e=e:e=!1,this.each(function(i){n=t(i).parent().children(),n.splice(n.indexOf(i),1),e?n.each(function(t){t.nodeName===e.toUpperCase()&&r.push(t)}):n.each(function(e){r.push(e)})}),r.length?r.unique():this},bind:function(e,n,r){return this.length?(r=r||!1,this.each(function(i){t.chch_cache.events.set(i,e,n,r)}),this):[]},unbind:function(e,n,r){if(!this.length)return[];var i;return this.each(function(s){if(!s.id||!t.chch_cache.events.hasKey(s.id))return this;r=r||!1,i=s.getAttribute("id"),t.chch_cache.events._delete(i,e,n,r)}),this},trigger:function(e){if(!this.length)return[];this.each(function(t){if(document.createEvent){var n=document.createEvent("Events");n.initEvent(e,!0,!1),t.dispatchEvent(n)}})},delegate:function(e,n,r,i){if(!this.length)return[];i=i||!1,this.each(function(s){s.addEventListener(n,function(n){var i=n.target;n.target.nodeType===3&&(i=n.target.parentNode),t(e,s).each(function(s){if(s===i)r.call(s,n);else try{var o=t(i).ancestor(e);s===o[0]&&r.call(s,n)}catch(u){}})},i)})},undelegate:function(e,n,r,i){if(!this.length)return[];this.each(function(e){t(e).unbind(n,r,i)})},on:function(e,n,r,i){if(!this.length)return[];!n&&/Object/img.test(e.constructor.toString())&&this.each(function(n){for(var r in e)e.hasOwnProperty(r)&&t(n).on(r,e[r])});var s=[],o;return typeof e=="string"&&(e=e.trim(),/\s/.test(e)&&(o=e.split(" "),o.length&&this.each(function(e){o.each(function(o){typeof n=="function"?(t(e).bind(o,n,r),s.push(e)):(t(e).delegate(n,o,r,i),s.push(e))})}))),this.each(function(o){typeof n=="function"?(t(o).bind(e,n,r),s.push(o)):(t(o).delegate(n,e,r,i),s.push(o))}),s.length?s:this},off:function(e,n,r,i){if(!this.length)return[];var s=[];return this.each(function(o){typeof n=="function"||!n?(t(o).unbind(e,n,r),s.push(o)):(t(o).undelegate(n,e,r,i),s.push(o))}),s.length?s:this},animate:function(e){if(!this.length)return[];var n=null,r=r||".5s",i=i||"linear",s={},o,u;return"ontransitionend"in window?(o="transition",u="transitionend"):(o="-webkit-transition",u="webkitTransitionEnd"),s[o]="all "+r+" "+i,this.forEach(function(r){for(var i in e)i==="onEnd"?(n=e[i],t(r).bind(u,n())):s[i]=e[i];t(r).css(s)}),this},data:function(e,n){if(!this.length)return[];var r,i,s=this[0];r=s.id;if(e==="undefined"||e===null)return;if(n)s.id?(r=s.id,t.chch_cache.data[r]?t.chch_cache.data[r][e]=n:(t.chch_cache.data[r]={},t.chch_cache.data[r][e]=n)):(++t.uuid,r=t.makeUuid(),s.setAttribute("id",r),t.chch_cache.data[r]={},t.chch_cache.data[r][e]=n);else if(e&&r){if(!t.chch_cache.data[r])return;if(!t.chch_cache.data[r][e])return;return t.chch_cache.data[r][e]}return this},removeData:function(e){if(!this.length)return[];this.each(function(n){var r=n.getAttribute("id");if(!r)return;return t.chch_cache.data[n.id]?e?(Object.keys(t.chch_cache.data[r]).length===0?delete t.chch_cache.data[r]:delete t.chch_cache.data[r][e],this):(delete t.chch_cache.data[r],this):this})},clone:function(e){if(!this.length)return[];var t=[];return this.each(function(n){e===!0||!e?t.push(n.cloneNode(!0)):t.push(n.cloneNode(!1))}),t.length?t[0]:this},wrap:function(e){return this.length?(this.each(function(n){var r=t.make(e);r=r[0];var i=t(n).clone(!0);r.appendChild(i),n.parentNode.insertBefore(r,n.nextSibling),t(n).remove(n)}),this):[]},unwrap:function(){if(!this.length)return[];var e=null;return this.each(function(n){if(n.parentNode===e)return;e=n.parentNode;if(n.parentNode.nodeName==="BODY")return!1;t.replace(n,n.parentNode)}),this},remove:function(){if(!this.length)return[];this.each(function(e){t(e).unbind(),t(e).removeData(),e.parentNode.removeChild(e)})},empty:function(){if(!this.length)return[];var n=[];return this.each(function(e){t(e).unbind(),e.textContent="",n.push(e)}),e(n)},ready:function(e){if(!this.length)return[];t.ready(function(){return e.call(e)})}}),t.extend(t,{DOMReadyList:[],executeWhenDOMReady:function(){var e=t.DOMReadyList.length,n=0;while(n<e)t.DOMReadyList[n](),n++;t.DOMReadyList=[],document.removeEventListener("DOMContentLoaded",t.executeWhenDOMReady,!1)},ready:function(e){document.getElementsByTagName("body")[0]?e():(t.DOMReadyList.length===0&&document.addEventListener("DOMContentLoaded",t.executeWhenDOMReady,!1),t.DOMReadyList.push(e))}}),t.extend(t,{camelize:function(e){if(typeof e!="string")return;return e.replace(/\-(.)/g,function(e,t){return t.toUpperCase()})},deCamelize:function(e){if(typeof e!="string")return;return e.replace(/([A-Z])/g,"-$1").toLowerCase()},capitalize:function(e,n){if(!e)return;if(typeof e!="string")return;if(n){var r=e.split(" "),i=[];return r.each(function(e){i.push(t.capitalize(e))}),i.join(" ")}return e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()}}),t.extend(t,{form2JSON:function(e,n){function o(e){var t=[],n=e.firstChild;while(n){if(n.nodeName.match(/INPUT|SELECT|TEXTAREA/i))t.push({name:n.name,value:u(n)});else{var r=o(n);t=t.concat(r)}n=n.nextSibling}return t}function u(e){if(e.nodeName==="INPUT"){if(e.type.toLowerCase()==="radio"||e.type.toLowerCase()==="checkbox"){if(e.checked)return e.value}else if(!e.type.toLowerCase().match(/button|reset|submit|image/i))return e.value}else{if(e.nodeName==="TEXTAREA")return e.value;if(e.nodeName==="SELECT")return a(e)}return""}function a(e){var n=e.multiple;if(!n)return e.value;if(e.selectedIndex>-1){var r=[];return t("option",e).each(function(e){e.selected&&r.push(e.value)}),r}}e=typeof e=="string"?t(e)[0]:e,n=n||".";var r=o(e),i={},s={};return r.each(function(e){var t=e.value;if(t!==""){var r=e.name,o=r.split(n),u=i;for(var a=0;a<o.length;a++){var f=o[a],l;if(f.indexOf("[]")>-1&&a===o.length-1)l=f.substr(0,f.indexOf("[")),u[l]||(u[l]=[]),u[l].push(t);else if(f.indexOf("[")>-1){l=f.substr(0,f.indexOf("["));var c=f.replace(/^[a-z]+\[|\]$/gi,"");s[l]||(s[l]={}),u[l]||(u[l]=[]),a===o.length-1?u[l].push(t):s[l][c]||(u[l].push({}),s[l][c]=u[l][u[l].length-1]),u=s[l][c]}else a<o.length-1?(u[f]||(u[f]={}),u=u[f]):u[f]=t}}}),i}}),t.extend(t,{ajax:function(e){var n={script:"text/javascript, application/javascript",json:"application/json",xml:"application/xml, text/xml",html:"text/html",text:"text/plain"},r=e?e:{},i=null,s=e.error||t.noop;!e||!r.success||(i=r.success);var o=new XMLHttpRequest,u=r.type||"get",a=r.async||!1,f=r.data||null;o.queryString=f,o.open(u,r.url,a);if(!!r.headers)for(var l in r.headers)r.headers.hasOwnProperty(l)&&o.setRequestHeader(l,r.headers[l]);r.dataType&&o.setRequestHeader("Content-Type",n[r.dataType]),o.handleResp=i!==null?i:t.noop;var c=function(){o.status===0&&o.readyState===4||o.status>=200&&o.status<300&&o.readyState===4||o.status===304&&o.readyState===4?r.dataType?r.dataType==="json"?o.handleResp(JSON.parse(o.responseText)):o.handleResp(o.responseText):o.handleResp(o.responseText):o.status>=400&&(!s||s(o))};return a&&(o.onreadystatechange=c),o.send(f),a||c(),this},get:function(e,n,r,i){if(!e)return;if(!n)return;typeof n=="function"&&!i?(typeof r=="string"&&(i=r),t.ajax({url:e,type:"GET",success:n,dataType:i})):typeof n=="object"&&typeof r=="function"&&t.ajax({url:e,type:"GET",data:n,dataType:i})},getJSON:function(e,n,r){if(!e)return;if(!n)return;typeof n=="function"&&!r?t.ajax({url:e,type:"GET",success:n,dataType:"json"}):typeof n=="object"&&typeof r=="function"&&t.ajax({url:e,type:"GET",data:n,dataType:"json"})},JSONP:function(e,n){var r="fn_"+t.uuidNum(),i=document.createElement("script"),s=t("head")[0];window[r]=function(e){s.removeChild(i),n&&n(e),delete window[r]},i.src=e.replace("callback=?","callback="+r),s.appendChild(i)},post:function(e,n,r,i){if(!e)return;if(!n)return;typeof n=="function"&&!i?(typeof r=="string"&&(i=r),t.ajax({url:e,type:"POST",success:n,dataType:i})):typeof n=="object"&&typeof r=="function"&&t.ajax({url:e,type:"POST",data:n,dataType:i})}}),t.extend(t,{isiPhone:/iphone/img.test(navigator.userAgent),isiPad:/ipad/img.test(navigator.userAgent),isiPod:/ipod/img.test(navigator.userAgent),isiOS:/ip(hone|od|ad)/img.test(navigator.userAgent),isAndroid:/android/img.test(navigator.userAgent)&&!/trident/img.test(navigator.userAgent),isWebOS:/webos/img.test(navigator.userAgent),isBlackberry:/blackberry/img.test(navigator.userAgent),isTouchEnabled:"createTouch"in document,isOnline:navigator.onLine,isStandalone:navigator.standalone,isiOS6:navigator.userAgent.match(/OS 6/i),isiOS7:navigator.userAgent.match(/OS 7/i),isWin:/trident/img.test(navigator.userAgent),isWinPhone:/trident/img.test(navigator.userAgent)&&/mobile/img.test(navigator.userAgent),isIE10:navigator.userAgent.match(/msie 10/i),isIE11:navigator.userAgent.match(/msie 11/i),isWebkit:navigator.userAgent.match(/webkit/),isMobile:/mobile/img.test(navigator.userAgent),isDesktop:!/mobile/img.test(navigator.userAgent),isSafari:!/Chrome/img.test(navigator.userAgent)&&/Safari/img.test(navigator.userAgent)&&!/android/img.test(navigator.userAgent),isChrome:/Chrome/img.test(navigator.userAgent),isNativeAndroid:/android/i.test(navigator.userAgent)&&/webkit/i.test(navigator.userAgent)&&!/chrome/i.test(navigator.userAgent)}),t.extend(t,{templates:{},template:function(e,t){var n,r,i;t=t?t:"data",n=/\[\[=([\s\S]+?)\]\]/g,r="[[",i="]]";var s=new Function(t,"var p=[];p.push('"+e.replace(/[\r\t\n]/g," ").split("'").join("\\'").replace(n,"',$1,'").split(r).join("');").split(i).join("p.push('")+"');"+"return p.join('');");return s}}),t.extend(t,{subscriptions:{},subscribe:function(e,n){var r=t.uuidNum();return t.subscriptions[e]||(t.subscriptions[e]=[]),t.subscriptions[e].push({token:r,callback:n}),r},unsubscribe:function(e){setTimeout(function(){for(var n in t.subscriptions)if(t.subscriptions[n])for(var r=0,i=t.subscriptions[n].length;r<i;r++)if(t.subscriptions[n][r].token===e)return t.subscriptions[n].splice(r,1),e;return!1})},publish:function(e,n){if(!t.subscriptions[e])return!1;setTimeout(function(){var r=t.subscriptions[e]?t.subscriptions[e].length:0;while(r--)t.subscriptions[e][r].callback(e,n);return!0})}}),t.extend({Deferred:function(e){var n="pending",r=[],i=[],s=[],o=null,u={done:function(){for(var e=0;e<arguments.length;e++){if(!arguments[e])continue;if(Array.isArray(arguments[e])){var t=arguments[e];for(var i=0;i<t.length;i++)n==="resolved"&&t[i].apply(this,o),r.push(t[i])}else n==="resolved"&&arguments[e].apply(this,o),r.push(arguments[e])}return this},fail:function(){for(var e=0;e<arguments.length;e++){if(!arguments[e])continue;if(Array.isArray(arguments[e])){var t=arguments[e];for(var r=0;r<t.length;r++)n==="rejected"&&t[r].apply(this,o),i.push(t[r])}else n==="rejected"&&arguments[e].apply(this,o),i.push(arguments[e])}return this},always:function(){return this.done.apply(this,arguments).fail.apply(this,arguments)},progress:function(){for(var e=0;e<arguments.length;e++){if(!arguments[e])continue;if(Array.isArray(arguments[e])){var t=arguments[e];for(var r=0;r<t.length;r++)n==="pending"&&s.push(t[r])}else n==="pending"&&s.push(arguments[e])}return this},then:function(){arguments.length>1&&arguments[1]&&this.fail(arguments[1]),arguments.length>0&&arguments[0]&&this.done(arguments[0]),arguments.length>2&&arguments[2]&&this.progress(arguments[2])},promise:function(e){if(e===null||e===undefined)return u;for(var t in u)e[t]=u[t];return e},state:function(){return n},debug:function(){console.log("[debug]",r,i,n)},isRejected:function(){return n==="rejected"},isResolved:function(){return n==="resolved"},pipe:function(e,n){var r=function(e,n){if(t.isArray(e))for(var r=0;r<e.length;r++)n(e[r]);else n(e)};return t.Deferred(function(t){r(e,function(e){typeof e=="function"?a.done(function(){var n=e.apply(this,arguments);n&&typeof n=="function"?n.promise().then(t.resolve,t.reject,t.notify):t.resolve(n)}):a.done(t.resolve)}),r(n,function(e){typeof e=="function"?a.fail(function(){var n=e.apply(this,arguments);n&&typeof n=="function"?n.promise().then(t.resolve,t.reject,t.notify):t.reject(n)}):a.fail(t.reject)})}).promise()}},a={resolveWith:function(e){if(n==="pending"){n="resolved",o=arguments.length>1?arguments[1]:[];for(var t=0;t<r.length;t++)r[t].apply(e,o)}return this},rejectWith:function(e){if(n==="pending"){n="rejected",o=arguments.length>1?arguments[1]:[];for(var t=0;t<i.length;t++)i[t].apply(e,o)}return this},notifyWith:function(e){if(n==="pending"){o=2<=arguments.length?t.slice.call(arguments,1):[];for(var r=0;r<s.length;r++)s[r].apply(e,o)}return this},resolve:function(){return this.resolveWith(this,arguments)},reject:function(){return this.rejectWith(this,arguments)},notify:function(){return this.notifyWith(this,arguments)}},f=u.promise(a);return e&&e.apply(f,[f]),f}}),t.extend({when:function(){if(arguments.length<2){var e=arguments.length?arguments[0]:undefined;return e&&typeof e.isResolved=="function"&&typeof e.isRejected=="function"?e.promise():t.Deferred().resolve(e).promise()}return function(e){var n=t.Deferred(),r=e.length,i=0,s=[];s.length=r;for(var o=0;o<e.length;o++)(function(t){e[t].done(function(){s[t]=arguments.length<2?arguments[0]:arguments,++i===r&&n.resolve.apply(n,s)}).fail(function(){n.reject(arguments)})})(o);return n.promise()}(arguments)}}),window.$chocolatechip=t,typeof window.$=="undefined"&&(window.$=t)}(),n("chocolatechip",function(e){return function(){var t,n;return t||e.$chocolatechip}}(this)),function(e){e.extend(e,{eventStart:null,eventEnd:null,eventMove:null,eventCancel:null,gestureLength:30}),window&&window.jQuery&&e===window.jQuery&&e.extend(e,{uuidNum:function(){return Math.floor((1+Math.random())*4294967296)},make:function(t){return e(t)},concat:function(e){return e instanceof Array?e.join(""):(e=Array.prototype.slice.apply(arguments),String.prototype.concat.apply(e.join("")))},subscriptions:{},subscribe:function(t,n){e.subscriptions[t]||(e.subscriptions[t]=[]);var r=e.uuidNum();return e.subscriptions[t].push({token:r,callback:n}),r},unsubscribe:function(t){setTimeout(function(){for(var n in e.subscriptions)if(e.subscriptions[n])for(var r=0,i=e.subscriptions[n].length;r<i;r++)if(e.subscriptions[n][r].token===t)return e.subscriptions[n].splice(r,1),t;return!1})},publish:function(t,n){if(!e.subscriptions[t])return!1;setTimeout(function(){var r=e.subscriptions[t]?e.subscriptions[t].length:0;while(r--)e.subscriptions[t][r].callback(t,n);return!0})},templates:{},template:function(e,t){var n,r,i;t=t?t:"data",n=/\[\[=([\s\S]+?)\]\]/g,r="[[",i="]]";var s=new Function(t,"var p=[];p.push('"+e.replace(/[\r\t\n]/g," ").split("'").join("\\'").replace(n,"',$1,'").split(r).join("');").split(i).join("p.push('")+"');"+"return p.join('');");return s},isiPhone:/iphone/img.test(navigator.userAgent),isiPad:/ipad/img.test(navigator.userAgent),isiPod:/ipod/img.test(navigator.userAgent),isiOS:/ip(hone|od|ad)/img.test(navigator.userAgent),isAndroid:/android/img.test(navigator.userAgent)&&!/trident/img.test(navigator.userAgent),isWebOS:/webos/img.test(navigator.userAgent),isBlackberry:/blackberry/img.test(navigator.userAgent),isTouchEnabled:"createTouch"in document,isOnline:navigator.onLine,isStandalone:navigator.standalone,isiOS6:navigator.userAgent.match(/OS 6/i),isiOS7:navigator.userAgent.match(/OS 7/i),isWin:/trident/img.test(navigator.userAgent),isWinPhone:/trident/img.test(navigator.userAgent)&&/mobile/img.test(navigator.userAgent),isIE10:navigator.userAgent.match(/msie 10/i),isIE11:navigator.userAgent.match(/msie 11/i),isWebkit:navigator.userAgent.match(/webkit/),isMobile:/mobile/img.test(navigator.userAgent),isDesktop:!/mobile/img.test(navigator.userAgent),isSafari:!/Chrome/img.test(navigator.userAgent)&&/Safari/img.test(navigator.userAgent)&&!/android/img.test(navigator.userAgent),isChrome:/Chrome/img.test(navigator.userAgent),isNativeAndroid:/android/i.test(navigator.userAgent)&&/webkit/i.test(navigator.userAgent)&&!/chrome/i.test(navigator.userAgent)}),e.extend(e,{UuidSeed:0,Uuid:function(){var t;return e.UuidSeed++,t=Date.now()+e.UuidSeed,t.toString(36)},array:Array.prototype,UITrackHashNavigation:function(t,n){t=t||!0,e.UISetHashOnUrl(e.UINavigationHistory[e.UINavigationHistory.length-1],n)},UISetHashOnUrl:function(t,n){n=n||"#/";var r;/^#/.test(t)?r=n+t.split("#")[1]:r=n+t,e.isAndroid?(/#/.test(t)&&(t=t.split("#")[1]),/\//.test(t)&&(t=t.split("/")[1]),window.location.hash="#/"+t):window.history.replaceState("Object","Title",r)},UIGoBackToArticle:function(t){var n=e.UINavigationHistory.indexOf(t),r=e("article.current"),i=e(t),s,o,u=e.UINavigationHistory.splice(n+1);e.publish("chui/navigateBack/leave",r[0].id),e.publish("chui/navigateBack/enter",i[0].id),r[0].scrollTop=0,i[0].scrollTop=0,u.length&&u.forEach(function(t){e("#"+t).removeClass("previous").addClass("next"),e("#"+t).prev().removeClass("previous").addClass("next")}),window&&window.jQuery&&e===window.jQuery?(r.next().hasClass("toolbar")?s=r.next("toolbar"):s=e(),i.next().hasClass("toolbar")?o=i.next("toolbar"):o=e()):(s=r.next().hasClass("toolbar"),o=i.next().hasClass("toolbar")),i.removeClass("previous").addClass("current"),i.prev().removeClass("previous").addClass("current"),o.removeClass("previous").addClass("current"),r.removeClass("current").addClass("next"),r.prev().removeClass("current").addClass("next"),s.removeClass("current").addClass("next"),e(".toolbar.previous").removeClass("previous").addClass("next"),e.UISetHashOnUrl(e.UINavigationHistory[e.UINavigationHistory.length-1])},UIGoBack:function(){var t=e.UINavigationHistory.length,n=e("article.current"),r=e(e.UINavigationHistory[t-2]),i,s;e.publish("chui/navigateBack/leave",n[0].id),e.publish("chui/navigateBack/enter",r[0].id),n[0].scrollTop=0,r[0].scrollTop=0,window&&window.jQuery&&e===window.jQuery?(n.next().hasClass("toolbar")?i=n.next(".toolbar"):i=e(),r.next().hasClass("toolbar")?s=r.next(".toolbar"):s=e()):(i=n.next().hasClass("toolbar"),s=r.next().hasClass("toolbar")),r.removeClass("previous").addClass("current"),r.prev().removeClass("previous").addClass("current"),s.removeClass("previous").addClass("current"),n.removeClass("current").addClass("next"),n.prev().removeClass("current").addClass("next"),i.removeClass("current").addClass("next"),e.UISetHashOnUrl(e.UINavigationHistory[t-2]),e.UINavigationHistory[t-1]!==e.firstArticle[0].id&&e.UINavigationHistory.pop()},isNavigating:!1,UIGoToArticle:function(t){if(e.isNavigating)return;e.isNavigating=!0;var n=e("article.current"),r=n.prev();t=e(t);var i="#"+t[0].id,s=t.prev(),o,u;e.publish("chui/navigate/leave",n[0].id),e.UINavigationHistory.push(i),e.publish("chui/navigate/enter",t[0].id),n[0].scrollTop=0,t[0].scrollTop=0,window&&window.jQuery&&e===window.jQuery?(n.next().hasClass("toolbar")?o=n.next(".toolbar"):o=e(),t.next().hasClass("toolbar")?u=t.next(".toolbar"):u=e()):(o=n.next().hasClass("toolbar"),u=t.next().hasClass("toolbar")),n.removeClass("current").addClass("previous"),r.removeClass("current").addClass("previous"),o.removeClass("current").addClass("previous"),t.removeClass("next").addClass("current"),s.removeClass("next").addClass("current"),u.removeClass("next").addClass("current"),e.UISetHashOnUrl(t[0].id),setTimeout(function(){e.isNavigating=!1},500)},UIDeletable:function(t){if(!t||!t.list||!t instanceof Array)return;var n=e(t.list),r=t.editLabel||"Edit",i=t.doneLabel||"Done",s=t.deleteLabel||"Delete",o=t.placement||"right",u=t.callback||e.noop,a,f,l,c;e.isWin&&(s="");if(n[0].classList.contains("deletable"))return;var h=e("li").eq(1)[0].clientHeight;a=e.concat('<a href="javascript:void(null)" class="button delete">',s,"</a>"),f=e.concat('<a href="javascript:void(null)" class="button edit">',r,"</a>"),l='<span class="deletion-indicator"></span>',o==="left"?n.closest("article").prev().prepend(f):(n.closest("article").prev().append(f),n.closest("article").prev().find("h1").addClass("buttonOnRight"),n.closest("article").prev().find(".edit").addClass("align-flush"),c=n.closest("article").prev().find(".edit")),n.find("li").prepend(l),n.find("li").append(a),e("li").find(".delete").each(function(t,n){window&&window.jQuery&&e===window.jQuery&&(t=n),(e.isiOS||e.isSafari)&&e(t).css({height:h+"px"})});var p=function(t,n,s){var o;console.dir(s),e.isiOS?o="100px":e.isAndroid&&(o="140px"),e(function(){s.on("singletap",function(){var t=this;this.classList.contains("edit")?(n.addClass("deletable"),setTimeout(function(){t.classList.remove("edit"),t.classList.add("done"),e(t).text(i),e(n).addClass("showIndicators")})):this.classList.contains("done")&&(n.removeClass("deletable"),setTimeout(function(){t.classList.remove("done"),t.classList.add("edit"),e(t).text(r),e(n).removeClass("showIndicators"),e(n).find("li").removeClass("selected")}))}),e(n).on("singletap",".deletion-indicator",function(){if(e(this).closest("li")[0].classList.contains("selected")){e(this).closest("li").removeClass("selected");return}e(this).closest("li").addClass("selected")}),(e.isiOS||e.isSafari)&&e(n).on("swiperight","li",function(){e(this).removeClass("selected")}),e(n).on("singletap",".delete",function(){var n=this;e(this).siblings().css({"-webkit-transform":"translate3d(-1000%,0,0)","-webkit-transition":"all 1s ease-out"}),setTimeout(function(){t.call(t,n),e(n).parent().remove()},500)})})};return p(u,n,c)},UIPaging:function(){var t=e(".segmented.paging").closest("nav").next();window&&window.jQuery&&e===window.jQuery?e(".segmented.paging").hasClass("horizontal")?t.addClass("horizontal"):e(".segmented.paging").hasClass("vertical")&&t.addClass("vertical"):e(".segmented.paging").hasClass("horizontal")[0]?t.addClass("horizontal"):e(".segmented.paging").hasClass("vertical")[0]&&t.addClass("vertical"),t.children().eq(0).addClass("current"),t.children().eq(0).siblings().addClass("next");var n=function(){return t.children().length};e(".segmented.paging").on(e.eventStart,".button:first-of-type",function(){if(n()===1)return;var r=e(this);r.next().removeClass("selected"),r.addClass("selected");var i;i=e("section.current"),i.index()===0?(i.removeClass("current"),t.children().eq(n()-1).addClass("current").removeClass("next"),t.children().eq(n()-1).siblings().removeClass("next").addClass("previous")):(i.removeClass("current").addClass("next"),i.prev().removeClass("previous").addClass("current")),setTimeout(function(){r.removeClass("selected")},250)}),e(".segmented.paging").on(e.eventStart,".button:last-of-type",function(){if(n()===1)return;var r=e(this);r.prev().removeClass("selected"),r.addClass("selected");var i;if(this.classList.contains("disabled"))return;i=e("section.current"),i.index()===n()-1?(i.removeClass("current"),t.children().eq(0).addClass("current").removeClass("previous"),t.children().eq(0).siblings().removeClass("previous").addClass("next")):(i.removeClass("current").addClass("previous"),i.next().removeClass("next").addClass("current")),setTimeout(function(){r.removeClass("selected")},250)})},UISlideout:function(t){var n=e.make("<a class='button slide-out-button' href='javascript:void(null)'></a>"),r='<div class="slide-out"><section></section></div>';e("article").removeClass("next"),e("article").removeClass("current"),e("article").prev().removeClass("next"),e("article").prev().removeClass("current"),t=t||"left",e.body.append(r),e.body.addClass("slide-out-app"),e("article:first-of-type").addClass("show"),e("article:first-of-type").prev().addClass("show"),e("#global-nav").append(n),e(".slide-out-button").on(e.eventStart,function(){e(".slide-out").toggleClass("open")}),e(".slide-out").on("singletap","li",function(){var t="#"+e(this).attr("data-show-article");e.UINavigationHistory[0]=t,e.UISetHashOnUrl(t),e.publish("chui/navigate/leave",e("article.show")[0].id),e.publish("chui/navigate/enter",t),e(".slide-out").removeClass("open"),e("article").removeClass("show"),e("article").prev().removeClass("show"),e(t).addClass("show"),e(t).prev().addClass("show")})},UIResetStepper:function(t){var n=e(t).data("ui-value").defaultValue;e(t).find("label").html(n),e(t).find("input")[0].value=n}}),e.fn.extend({UISwitch:function(){var t=!1;this.each(function(n,r){window&&window.jQuery&&e===window.jQuery&&(n=r),n.setAttribute("role","checkbox");if(e(n).data("ui-setup")===!0)return;n.querySelector("input")||n.insertAdjacentHTML("afterBegin",'<input type="checkbox">'),n.classList.contains("on")&&n.querySelector("input").setAttribute("checked","checked"),n.querySelector("em")&&(t=!0),t||n.insertAdjacentHTML("afterBegin","<em></em>"),e(n).on("singletap",function(){var e=n.querySelector("input");n.classList.contains("on")?(n.classList.remove("on"),n.removeAttribute("aria-checked"),e.removeAttribute("checked")):(n.classList.add("on"),e.setAttribute("checked","checked"),n.setAttribute("aria-checked",!0))}),e(n).on("swipeleft",function(){var e=n.querySelector("input");n.classList.contains("on")&&(n.classList.remove("on"),n.removeAttribute("aria-checked"),e.removeAttribute("checked"))}),e(n).on("swiperight",function(){var e=n.querySelector("input");n.classList.contains("on")||(n.classList.add("on"),e.setAttribute("checked","checked"),n.setAttribute("aria-checked",!0))}),e(n).data("ui-setup",!0)})},UISegmented:function(t){if(window&&window.jQuery&&e===window.jQuery){if(this.hasClass("paging"))return}else if(this.hasClass("paging")[0])return;var n=t&&t.callback?t.callback:e.noop,r;t&&t.selected&&(r=t.selected),t&&t.callback&&(n=t.callback),this.find("a").each(function(t,n){window&&window.jQuery&&e===window.jQuery&&(t=n),e(t).find("a").attr("role","radio"),r===0&&n===0&&(t.setAttribute("aria-checked","true"),t.classList.add("selected")),n===r&&(t.setAttribute("aria-checked","true"),t.classList.add("selected"))}),r||this.find(".selected")[0]||this.children().eq(0).addClass("selected"),this.on("singletap",".button",function(t){var r=e(this);if(this.parentNode.classList.contains("paging"))return;r.siblings("a").removeClass("selected"),r.siblings("a").removeAttr("aria-checked"),r.addClass("selected"),r.attr("aria-checked",!0),n.call(this,t)})},UIPanelToggle:function(t,n){var r,i=0;window&&window.jQuery&&e===window.jQuery?e(this).children().hasClass("selected")&&this.children().each(function(t,n){e(n).hasClass("selected")&&(i=t)}):this.children().hasClass("selected")[0]&&(i=this.children().hasClass("selected").index()),t instanceof Array?r=t.children("div"):typeof t=="string"&&(r=e(t).children("div")),r.eq(i).siblings().css({display:"none"}),n&&n.apply(this,arguments),this.on(e.eventEnd,"a",function(){r.eq(e(this).index()).css({display:"block"}).siblings().css("display","none")}),this.on("singletap",".button",function(){var t=e(this);if(this.parentNode.classList.contains("paging"))return;t.siblings("a").removeClass("selected"),t.siblings("a").removeAttr("aria-checked"),t.addClass("selected"),t.attr("aria-checked",!0)})},UISelectList:function(t){var n=t&&t.name?t.name:e.Uuid(),r=this[0];window&&window.jQuery&&e===window.jQuery?r&&!e(r).hasClass("select")&&this.addClass("select"):r&&!e(r).hasClass("select")[0]&&this.addClass("select");if(!r)return[];r.classList.add("select"),e(r).find("li").each(function(r,i){var s;window&&window.jQuery&&e===window.jQuery&&(s=r,r=i,i=s),r.setAttribute("role","radio"),t&&t.selected===i?(r.setAttribute("aria-checked","true"),r.classList.add("selected"),e(r).find("input")[0]?e(r).find("input").attr("checked","checked"):e(r).append('<input type="radio" checked="checked" name="'+n+'">')):e(r).find("input")[0]||e(r).append('<input type="radio" name="'+n+'">')}),e(r).on("singletap","li",function(){var n=this;e(n).siblings("li").removeClass("selected"),e(n).siblings("li").removeAttr("aria-checked"),e(n).siblings("li").find("input").removeAttr("checked"),e(n).addClass("selected"),n.setAttribute("aria-checked",!0),e(n).find("input").attr("checked","checked"),t&&t.callback&&t.callback.apply(this,arguments)})},UIStepper:function(t){if(!t)return[];if(!t.start)return[];if(!t.end)return[];var n=this[0],r=t.start,i=t.end,s=t.defaultValue?t.defaultValue:t.start,o="+",u="-";e.isWin&&(o="",u="");var a='<a href="javascript:void(null)" class="button decrease">'+u+"</a>",f="<label>"+s+'</label><input type="text" value="'+s+'">',l='<a href="javascript:void(null)" class="button increase">'+o+"</a>";e(n).append(a+f+l),e(n).data("ui-value",{start:r,end:i,defaultValue:s});var c=function(){var t=e(n).find("input").val(),r=e(n).data("ui-value"),i=r.start,s;t<=i?e(this).addClass("disabled"):(s=Number(t)-1,e(n).find(".button:last-of-type").removeClass("disabled"),e(n).find("label").text(s),e(n).find("input")[0].value=s,t===i&&e(this).addClass("disabled"))},h=function(){var t=e(n).find("input").val(),r=e(n).data("ui-value"),i=r.end,s;t>=i?e(this).addClass("disabled"):(s=Number(t)+1,e(n).find(".button:first-of-type").removeClass("disabled"),e(n).find("label").text(s),e(n).find("input")[0].value=s,t===i&&e(this).addClass("disabled"))},p=window&&window.jQuery&&e===jQuery?e(n):[n];p.find(".button:first-of-type").on("singletap",function(){c.call(this,n)}),p.find(".button:last-of-type").on("singletap",function(){h.call(this,n)})},UIBusy:function(t){t=t||{};var n=this,r=t.color||"#000",i=t.size||"80px",s=t&&t.position==="right"?"align-flush":null,o=t.duration||"2s",u,a=function(){var t={"-webkit-animation-duration":o};return u=e.make('<span class="busy"></span>'),e(u).css({"background-color":r,height:i,width:i}),e(u).css(t),e(u).attr("role","progressbar"),s&&e(u).addClass(s),n.append(u),this},f=function(){var t={"-webkit-animation-duration":o};return u=e.make('<div class="busy"><div></div><div></div></div>'),e(u).css({height:i,width:i,"background-image":"url(\"data:image/svg+xml;utf8,<svg xmlns:svg='http://www.w3.org/2000/svg' xmlns='http://www.w3.org/2000/svg' version='1.1' x='0px' y='0px' width='400px' height='400px' viewBox='0 0 400 400' enable-background='new 0 0 400 400' xml:space='preserve'><circle fill='none' stroke='"+r+"' stroke-width='20' stroke-miterlimit='10' cx='199' cy='199' r='174'/>"+'</svg>"'+")"}),e(u).css(t),e(u).attr("role","progressbar"),e(u).innerHTML="<div></div><div></div>",s&&e(u).addClass("align-"+s),n.append(u),this},l=function(){return u=e.make('<progress class="busy"></progress>'),e(u).css({color:r}),e(u).attr("role","progressbar"),e(u).addClass("win-ring"),s&&e(u).addClass("align-"+s),n.append(u),this};e.isWin?l(t):e.isAndroid||e.isChrome?f(t):(e.isiOS||e.isSafari)&&a(t)},UICenter:function(){if(!this[0])return;var t=e(this),n=t.parent(),r;t.css("position")!=="absolute"?r="relative":r="absolute";var i,s,o,u;r==="absolute"?(i=t[0].clientHeight,s=t[0].clientWidth,o=n[0].clientHeight,u=n[0].clientWidth):(i=parseInt(t.css("height"),10),s=parseInt(t.css("width"),10),o=parseInt(n.css("height"),10),u=parseInt(n.css("width"),10));var a,f;n[0].nodeName==="body"?(a=window.innerHeight/2+window.pageYOffset-i/2+"px",f=window.innerWidth/2-s/2+"px"):(a=o/2-i/2+"px",f=u/2-s/2+"px"),r!=="absolute"&&(f=0),t.css({left:f,top:a})},UIBlock:function(t){return t=t?" style='opacity:"+t+"'":" style='opacity: .5;'",e(this).before("<div class='mask'"+t+"></div>"),e("article.current").attr("aria-hidden",!0),this},UIUnblock:function(){return e(".mask").remove(),e("article.current").removeAttr("aria-hidden"),this},UIPopupClose:function(){if(!this[0].classList.contains("popup"))return;e(this).UIUnblock(),e(this).remove()},UIPopover:function(t){if(!t)return[];var n=e(this),r;this[0].id?r=this[0].id:(r=e.Uuid(),n.attr("id",r));var i=t.id?t.id:e.Uuid(),s=t.title?"<header><h1>"+t.title+"</h1></header>":"",o=t.callback?t.callback:e.noop,u='<div class="popover" id="'+i+'">'+s+"<section></section></div>",a=function(t){var n=e(t).offset(),r=n.left,i,s,o=e(".popover"),u=o.offset();i=u.left,s=n.top+e(t)[0].clientHeight,o.width()+n.left>window.innerWidth?o.css({left:window.innerWidth-o.width()-20+"px",top:s+20+"px"}):o.css({left:r+"px",top:s+20+"px"})};e(this).on(e.eventStart,function(){var t=this;e(this).addClass("selected"),setTimeout(function(){e(t).removeClass("selected")},1e3),e.body.append(u),e(".popover").UIBlock(".5");var n="singletap";e.isWin&&e.isDesktop&&(n=e.eventStart+" singletap "+e.eventEnd),e(".mask").on(n,function(e){e.preventDefault(),e.stopPropagation()}),e(".popover").data("triggerEl",r),e.isWin?(a(t),e(".popover").addClass("open")):(e(".popover").addClass("open"),setTimeout(function(){a(t)})),o.call(o,t)})}}),e.extend(e,{UICreateSwitch:function(t){var n=t?t.id:e.Uuid(),r=t&&t.name?' name="'+t.name+'"':"",i=t&&t.value?' value="'+t.value+'"':"",s=t&&t.state==="on"?" "+t.state:"",o=t&&t.state==="on"?' checked="checked"':"",u=e.concat('<span class="switch',s,'" id="',n,'"><em></em>','<input type="checkbox"',r,o,i,"></span>");return e.make(u)},UICreateSegmented:function(e){var t=e&&e.className?e.className:"",n=e&&e.labels?e.labels:[],r=e&&e.selected?e.selected:0,i=['<div class="segmented'];return t&&i.push(" "+t),i.push('">'),n.forEach(function(e,t){i.push('<a role="radio" class="button'),r===t?i.push(' selected" aria-checked="true"'):i.push('"'),i.push(">"),i.push(e),i.push("</a>")}),i.push("</div>"),i.join("")},UIPopup:function(t){if(!t)return;var n=t.id||e.Uuid(),r=t.title?"<header><h1>"+t.title+"</h1></header>":"",i=t.message?'<p role="note">'+t.message+"</p>":"",s=t.cancelButton?'<a href="javascript:void(null)" class="button cancel" role="button">'+t.cancelButton+"</a>":"",o=t.continueButton?'<a href="javascript:void(null)" class="button continue" role="button">'+t.continueButton+"</a>":"",u=t.callback||e.noop,a=t.empty?' style="padding: 40px 0;" ':"",f,l;t.empty?(f="",l=""):(f='<div class="panel">',l="</div>");var c='<div class="popup closed" role="alertdialog" id="'+n+'"'+a+">"+f+r+i+"<footer>"+s+o+"</footer>"+l+"</div>";e.body.append(c),u&&o&&e(".popup").find(".continue").on(e.eventStart,function(){e(".popup").UIPopupClose(),u.call(u)}),e.UICenterPopup(),setTimeout(function(){e.body.find(".popup").removeClass("closed")},200),e.body.find(".popup").UIBlock("0.5");var h=e.eventStart+" singletap "+e.eventEnd;e(".mask").on(h,function(e){e.stopPropagation()})},UICenterPopup:function(){var t=e(".popup");if(!t[0])return;var n=window.innerHeight/2+window.pageYOffset-t[0].clientHeight/2+"px",r;window.innerWidth===320?r="10px":r=Math.floor((window.innerWidth-318)/2)+"px",e.isWin?t.css({top:n}):t.css({left:r,top:n})},UIAlignPopover:function(){var t=e(".popover");if(!t.length)return;var n=t.data("triggerEl"),r=e("#"+n).offset(),i=r.left;e(t).width()+r.left>window.innerWidth?t.css({left:window.innerWidth-e(t).width()-20+"px"}):t.css({left:i+"px"})},UIPopoverClose:function(){e.body.UIUnblock(),e(".popover").css("visibility","hidden"),setTimeout(function(){e(".popover").remove()},10)},UITabbar:function(t){if(!t)return;e.body.addClass("hasTabBar"),e.isiOS6&&e.body.addClass("isiOS6");var n=t.id||e.Uuid(),r=t.selected||"",i='<div class="tabbar" id="'+n+'">',s=e.isiOS||e.isSafari?'<span class="icon"></span>':"";for(var o=0;o<t.tabs;o++)i+='<a class="button '+t.icons[o],r===o+1&&(i+=" selected"),i+='">'+s+"<label>"+t.labels[o]+"</label></a>";i+="</div>",e.body.append(i),e("nav").removeClass("current").addClass("next"),e("nav").eq(r).removeClass("next").addClass("current"),e("article").removeClass("current").addClass("next"),e("article").eq(r-1).removeClass("next").addClass("current"),e.body.find(".tabbar").on("singletap",".button",function(){var t=this,n,r;e.publish("chui/navigate/leave",e("article.current")[0].id),t.classList.add("selected"),e(this).siblings("a").removeClass("selected"),n=e(this).index(),e(".previous").removeClass("previous").addClass("next"),e(".current").removeClass("current").addClass("next"),r=e("article").eq(n)[0].id,e.publish("chui/navigate/enter",r),window&&window.jQuery?e("article").each(function(t,n){e(n).scrollTop(0)}):e("article").eq(n).siblings("article").forEach(function(e){e.scrollTop=0}),e.UISetHashOnUrl("#"+r),e.UINavigationHistory[0]==="#"+r?e.UINavigationHistory=[e.UINavigationHistory[0]]:e.UINavigationHistory.length===1?e.UINavigationHistory[0]!=="#"+r&&e.UINavigationHistory.push("#"+r):e.UINavigationHistory.length===3?e.UINavigationHistory.pop():e.UINavigationHistory[1]="#"+r,e("article").eq(n).removeClass("next").addClass("current"),e("nav").eq(n+1).removeClass("next").addClass("current")})},UISheet:function(t){var n=e.Uuid(),r="",i="";t&&(n=t.id?t.id:n,r=t.listClass?" "+t.listClass:"",i=' style="background-color:'+t.background+';" '||"");var s='<div id="'+n+'" class="sheet'+r+'"><div class="handle"></div><section class="scroller-vertical"></section></div>';e.body.append(s),e(".sheet .handle").on(e.eventStart,function(){e.UIHideSheet()})},UIShowSheet:function(){e("article.current").addClass("blurred"),e.isAndroid||e.isChrome?(e(".sheet").css("display","block"),setTimeout(function(){e(".sheet").addClass("opened")},20)):e(".sheet").addClass("opened")},UIHideSheet:function(){e(".sheet").removeClass("opened"),e("article.current").addClass("removeBlurSlow"),setTimeout(function(){e("article").removeClass("blurred"),e("article").removeClass("removeBlurSlow")},500)},UIDesktopCompat:function(){e.isDesktop&&e.isSafari?e.body.addClass("isiOS").addClass("isDesktopSafari"):e.isDesktop&&e.isChrome&&e.body.addClass("isAndroid").addClass("isDesktopChrome")}}),e.extend(e.UISlideout,{populate:function(t){var n=e(".slide-out");if(!n[0])return;if(!e.isArray(t))return;n.find("section").append('<ul class="list"></ul>');var r=n.find("ul");t.forEach(function(e){for(var t in e)t==="header"?r.append('<li class="slideout-header"><h2>'+e[t]+"</h2></li>"):r.append('<li data-show-article="'+t+'"><h3>'+e[t]+"</h3></li>")})}}),e(function(){window.navigator.msPointerEnabled?(e.eventStart="MSPointerDown",e.eventEnd="MSPointerUp",e.eventMove="MSPointerMove",e.eventCancel="MSPointerCancel"):window.navigator.pointerEnabled?(e.eventStart="pointerdown",e.eventEnd="pointerup",e.eventMove="pointermove",e.eventCancel="pointercancel"):"ontouchstart"in window?(e.eventStart="touchstart",e.eventEnd="touchend",e.eventMove="touchmove",e.eventCancel="touchcancel"):(e.eventStart="mousedown",e.eventEnd="click",e.eventMove="mousemove",e.eventCancel="mouseout"),e.body=e("body"),e.firstArticle=e("article").eq(0),/android/img.test(navigator.userAgent)&&/webkit/img.test(navigator.userAgent)&&!/Chrome/img.test(navigator.userAgent)&&document.body.classList.add("isNativeAndroidBrowser"),e("nav").on(e.eventStart,function(e){e.preventDefault()}),e.extend(e,{UINavigationHistory:["#"+e("article").eq(0).attr("id")]}),e("nav").each(function(t,n){var r;window&&window.jQuery&&e===window.jQuery&&(r=t,t=n,n=r);if(e.body[0].classList.contains("splitlayout"))return;n===0?t.classList.add("current"):t.classList.add("next")}),e("article").each(function(t,n){var r;window&&window.jQuery&&e===window.jQuery&&(r=t,t=n,n=r);if(e.body[0].classList.contains("splitlayout"))return;if(e.body[0].classList.contains("slide-out-app"))return;n===0?t.classList.add("current"):t.classList.add("next")}),e.body[0].classList.contains("splitlayout")||e.body.prepend("<nav id='global-nav'></nav>"),e.body.on("singletap","a.back",function(){this.classList.contains("back")&&e.UIGoBack()}),e.body.on("singletap",".button",function(){var t=e(this);if(t.parent()[0].classList.contains("tabbar"))return;t.addClass("selected"),setTimeout(function(){t.removeClass("selected")},500),this.classList.contains("show-popover")&&(t.addClass("selected"),setTimeout(function(){t.removeClass("selected")},500))}),e.body.on("singletap doubletap","li",function(){if(e.isNavigating)return;if(!this.hasAttribute("data-goto"))return;if(!this.getAttribute("data-goto"))return;if(!document.getElementById(this.getAttribute("data-goto")))return;if(e(this).parent()[0].classList.contains("deletable"))return;var t="#"+this.getAttribute("data-goto");e(t).addClass("navigable");var n=e(t);e.UIGoToArticle(n)}),e("li[data-goto]").each(function(t,n){window&&window.jQuery&&e===window.jQuery&&(t=n),e(t).closest("article").addClass("navigable");var r="#"+t.getAttribute("data-goto");e(r).addClass("navigable")}),e("article").eq(1)[0]&&e.UISetHashOnUrl(e("article").eq(0)[0].id),e(".segmented").UISegmented(),e(".switch").UISwitch(),e.body.on(e.eventStart,".cancel",function(){e(this).closest(".popup")[0]&&e(this).closest(".popup").UIPopupClose()}),window.onresize=function(){e.UICenterPopup(),e.UIAlignPopover()};var t=e.eventStart+" singletap "+e.eventEnd;e.body.on(t,".mask",function(t){if(!e(".popover")[0]){if(t&&t.nodeType===1)return;t.stopPropogation()}else e.UIPopoverClose()}),e.body[0].classList.contains("splitlayout")&&window.innerWidth<768&&e("meta[name=viewport]").attr("content","width=device-width, initial-scale=0.45, maximum-scale=2, user-scalable=yes"),e("h1").each(function(t,n){window&&window.jQuery&&e===window.jQuery&&(t=n),t.nextElementSibling&&t.nextElementSibling.nodeName==="A"&&t.classList.add("buttonOnRight")}),e(".toolbar").prev().addClass("has-toolbar"),e.extend({browserVersion:function(){var e=navigator.appName,t=navigator.userAgent,n,r=t.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);return r&&(n=t.match(/version\/([\.\d]+)/i))!==null&&(r[2]=n[1]),r=r?[r[1],r[2]]:[e,navigator.appVersion,"-?"],r[1]}}),e.isWin?e.body.addClass("isWindows"):e.isiOS?e.body.addClass("isiOS"):e.isAndroid&&e.body.addClass("isAndroid"),e.isSafari&&parseInt(e.browserVersion(),10)===6&&e.body.addClass("isSafari6"),e.UIDesktopCompat()})}(this.$),function(e){function a(e){return"tagName"in e?e:e.parentNode}function f(e,t,n,r){return Math.abs(e-t)>=Math.abs(n-r)?e-t>0?"left":"right":n-r>0?"up":"down"}function l(){u=null;if(t.last)try{t&&t.el&&(t.el.trigger("longtap"),t={})}catch(e){}}function c(){u&&clearTimeout(u),u=null}function h(){n&&clearTimeout(n),i&&clearTimeout(i),r&&clearTimeout(r),u&&clearTimeout(u),n=i=r=u=null,t={}}var t={},n,r,i,s=750,o=150,u;e(function(){var p,d,v=e(document.body),m=!1;v.on(e.eventStart,function(r){p=Date.now(),d=p-(t.last||p),r.originalEvent&&(r=r.originalEvent);if(window.navigator.msPointerEnabled||window.navigator.pointerEnabled){if(window&&window.jQuery&&e===window.jQuery){if(r.originalEvent&&!r.originalEvent.isPrimary)return}else if(!r.isPrimary)return;r=r.originalEvent?r.originalEvent:r,v.on("MSHoldVisual",function(e){e.preventDefault()}),t.el=e(a(r.target)),n&&clearTimeout(n),t.x1=r.pageX,t.y1=r.pageY,m=!1}else e.eventStart==="mousedown"?(t.el=e(a(r.target)),n&&clearTimeout(n),t.x1=r.pageX,t.y1=r.pageY,m=!1):r.touches.length===1&&(t.el=e(a(r.touches[0].target)),n&&clearTimeout(n),t.x1=r.touches[0].pageX,t.y1=r.touches[0].pageY,r.targetTouches.length===2?m=!0:m=!1);d>0&&d<=250&&(t.isDoubleTap=!0),t.last=p,u=setTimeout(l,s)}),v.on(e.eventMove,function(n){n.originalEvent&&(n=n.originalEvent);if(window.navigator.msPointerEnabled){if(window&&window.jQuery&&e===window.jQuery){if(n.originalEvent&&!n.originalEvent.isPrimary)return}else if(!n.isPrimary)return;n=n.originalEvent?n.originalEvent:n,c(),t.x2=n.pageX,t.y2=n.pageY}else c(),e.eventMove==="mousemove"?(t.x2=n.pageX,t.y2=n.pageY):n.touches.length===1&&(t.x2=n.touches[0].pageX,t.y2=n.touches[0].pageY)}),v.on(e.eventEnd,function(s){if(window.navigator.msPointerEnabled)if(window&&window.jQuery&&e===window.jQuery){if(s.originalEvent&&!s.originalEvent.isPrimary)return}else if(!s.isPrimary)return;c();if(!t.el)return;t.x2&&Math.abs(t.x1-t.x2)>e.gestureLength||t.y2&&Math.abs(t.y1-t.y2)>e.gestureLength?r=setTimeout(function(){t&&t.el&&(t.el.trigger("swipe"),t.el.trigger("swipe"+f(t.x1,t.x2,t.y1,t.y2)),t={})},0):"last"in t&&(i=setTimeout(function(){t&&t.el&&t.el.trigger("tap"),t&&t.isDoubleTap?t&&t.el&&(t.el.trigger("doubletap"),t={}):n=setTimeout(function(){n=null;if(t&&t.el)return t.el.trigger("singletap"),t={},!1},o)},0))}),v.on("touchcancel",h),e("body").on("webkitTransitionEnd transitionend","article",function(t){t.target.nodeName==="ARTICLE"&&t.target.classList.contains("current")&&e(t.target).trigger("navigationend")})}),["swipe","swipeleft","swiperight","swipeup","swipedown","doubletap","tap","singletap","longtap"].forEach(function(t){e.fn.extend({method:function(e){return this.on(t,e)}})})}(this.$),n("chui",["chocolatechip"],function(e){return function(){var t,n;return t||e.$}}(this)),n("app/UIPagingPatch",["chui"],function(e){e.UIPaging=function(){var t=e(".segmented.paging").closest("nav").next();window&&window.jQuery&&e===window.jQuery?e(".segmented.paging").hasClass("horizontal")?t.addClass("horizontal"):e(".segmented.paging").hasClass("vertical")&&t.addClass("vertical"):e(".segmented.paging").hasClass("horizontal")[0]?t.addClass("horizontal"):e(".segmented.paging").hasClass("vertical")[0]&&t.addClass("vertical"),t.children().eq(0).addClass("current"),t.children().eq(0).siblings().addClass("next");var n=function(){return t.children().length};e(".segmented.paging").on(e.eventStart,".button:first-of-type",function(){if(n()===1)return;var r=e(this);r.next().removeClass("selected"),r.addClass("selected");var i;i=e("section.current"),i.index()===0?(i.removeClass("current"),t.children().eq(n()-1).addClass("current").removeClass("next"),t.children().eq(n()-1).siblings().removeClass("next").addClass("previous")):(i.removeClass("current").addClass("next"),i.prev().removeClass("previous").addClass("current")),setTimeout(function(){r.removeClass("selected")},250)}),e(".segmented.paging").on(e.eventStart,".button:last-of-type",function(){if(n()===1)return;var r=e(this);r.prev().removeClass("selected"),r.addClass("selected");var i;if(this.classList.contains("disabled"))return;i=e("section.current"),i.index()===n()-1?(i.removeClass("current"),t.children().eq(0).addClass("current").removeClass("previous"),t.children().eq(0).siblings().removeClass("previous").addClass("next")):(i.removeClass("current").addClass("previous"),i.next().removeClass("next").addClass("current")),setTimeout(function(){r.removeClass("selected")},250)})},e.UIDeletable=function(t){if(!t||!t.list||!t instanceof Array)return;var n=t.list,r=t.editLabel||"Edit",i=t.doneLabel||"Done",s=t.deleteLabel||"Delete",o=t.placement||"right",u=t.callback||e.noop,a,f,l;e.isWin&&(s=""),e.doneCallbacks||(e.doneCallbacks={});var c=function(t){var s;e.isiOS?s="100px":e.isAndroid&&(s="140px"),e(function(){e.doneCallbacks[t]||(e.doneCallbacks[t]=!0,e.body.on("singletap",".edit",function(){var t=this;setTimeout(function(){t.classList.remove("edit"),t.classList.add("done"),e(t).text(i),e(n).addClass("showIndicators")})}),e.body.on("singletap",".done",function(){var t=this;setTimeout(function(){t.classList.remove("done"),t.classList.add("edit"),e(t).text(r),e(n).removeClass("showIndicators"),e(n).find("li").removeClass("selected")})}),e.body.on("singletap",".deletion-indicator",function(){if(e(this).closest("li")[0].classList.contains("selected")){e(this).closest("li").removeClass("selected");return}e(this).closest("li").addClass("selected")})),(e.isiOS||e.isSafari)&&e(n).on("swiperight singletap","li",function(){e(this).removeClass("selected")}),e(n).on("singletap",".delete",function(){var i=this;e(this).siblings().css({"-webkit-transform":"translate3d(-1000%,0,0)","-webkit-transition":"all 1s ease-out"}),setTimeout(function(){t.call(t,i),e(i).parent().remove(),e(n).children().length===0&&(i=e(n).closest("article").prev().find(".done"),i.removeClass("done").addClass("edit"),e(i).text(r),e(n).removeClass("showIndicators"),e(n).find("li").removeClass("selected"))},500)})})},h=e(n);if(h[0].classList.contains("deletable"))return;a=e.concat('<a href="javascript:void(null)" class="button delete">',s,"</a>"),f=e.concat('<a href="javascript:void(null)" class="button edit">',r,"</a>"),l='<span class="deletion-indicator"></span>';var p=h.closest("article").prev();return p&&p.find&&(p.find(".edit").remove(),p.find(".done").remove()),o==="left"?h.closest("article").prev().prepend(f):(h.closest("article").prev().append(f),h.closest("article").prev().find("h1").addClass("buttonOnRight"),h.closest("article").prev().find(".edit").addClass("align-flush")),h.find("li").prepend(l),h.find("li").append(a),e("li").find(".delete").each(function(t,n){window&&window.jQuery&&e===window.jQuery&&(t=n),(e.isiOS||e.isSafari)&&e(t).css({height:"100%"})}),c(u),h.addClass("deletable"),h},e.UIGoBack_=function(){var t=e.UINavigationHistory.length;if(t>1){var n=e("article.current"),r=e(e.UINavigationHistory[t-2]),i,s;window&&window.jQuery&&e===window.jQuery?(n.next().hasClass("toolbar")&&(i=n.next("toolbar")),r.next().hasClass("toolbar")&&(s=r.next("toolbar"))):(i=n.next().hasClass("toolbar"),s=r.next().hasClass("toolbar")),i.removeClass("current").addClass("next"),s.removeClass("previous").addClass("current"),r.removeClass("previous").removeClass("next").addClass("current"),r.prev().removeClass("previous").removeClass("next").addClass("current"),n.removeClass("current").addClass("next"),n.prev().removeClass("current").addClass("next"),e.UISetHashOnUrl(e.UINavigationHistory[t-2]),e.UINavigationHistory[t-1]!==e.firstArticle[0].id&&e.UINavigationHistory.pop()}},e.UITabbar=function(t){if(!t)return;e.body.addClass("hasTabBar"),e.isiOS6&&e.body.addClass("isiOS6");var n=t.id||e.Uuid(),r=t.selected||"",i='<div class="tabbar" id="'+n+'">',s=e.isiOS||e.isSafari?'<span class="icon"></span>':"";for(var o=0;o<t.tabs;o++)i+='<a class="button '+t.icons[o],r===o+1&&(i+=" selected"),i+='">'+s+"<label>"+t.labels[o]+"</label></a>";i+="</div>",e.body.append(i),e("nav").removeClass("current").addClass("next"),e("nav").eq(r).removeClass("next").addClass("current"),e("article").removeClass("current").addClass("next"),e("article").eq(r-1).removeClass("next").addClass("current"),e.body.find(".tabbar").on("singletap",".button",function(){var t=this,n,r;e.publish("chui/navigate/leave",e("article.current")[0].id),t.classList.add("selected"),e(this).siblings("a").removeClass("selected"),n=e(this).index(),e("article.previous").removeClass("previous").addClass("next"),e("nav.previous").removeClass("previous").addClass("next"),e("article.current").removeClass("current").addClass("next"),e("nav.current").removeClass("current").addClass("next"),r=e("article").eq(n)[0].id,e.publish("chui/navigate/enter",r),window&&window.jQuery?e("article").each(function(t,n){e(n).scrollTop(0)}):e("article").eq(n).siblings("article").forEach(function(e){e.scrollTop=0}),e.UISetHashOnUrl("#"+r),e.UINavigationHistory[0]==="#"+r?e.UINavigationHistory=[e.UINavigationHistory[0]]:e.UINavigationHistory.length===1?e.UINavigationHistory[0]!=="#"+r&&e.UINavigationHistory.push("#"+r):e.UINavigationHistory.length===3?e.UINavigationHistory.pop():e.UINavigationHistory[1]="#"+r,e("article").eq(n).removeClass("next").addClass("current"),e("nav").eq(n+1).removeClass("next").addClass("current")})},UIGoToArticle=function(t){if(e.isNavigating)return;e.isNavigating=!0;var n=e("article.current"),r=n.prev();t=e(t);var i="#"+t[0].id,s=t.prev(),o,u;e.publish("chui/navigate/leave",n[0].id),e.UINavigationHistory.push(i),e.publish("chui/navigate/enter",t[0].id),n[0].scrollTop=0,t[0].scrollTop=0,window&&window.jQuery&&e===window.jQuery?(n.next().hasClass("toolbar")?o=n.next(".toolbar"):o=e(),t.next().hasClass("toolbar")?u=t.next(".toolbar"):u=e()):(o=n.next().hasClass("toolbar"),u=t.next().hasClass("toolbar")),n.removeClass("current").addClass("previous"),r.removeClass("current").addClass("previous"),o.removeClass("current").addClass("previous"),t.removeClass("next").addClass("current"),s.removeClass("next").addClass("current"),u.removeClass("next").addClass("current"),e.UISetHashOnUrl(t[0].id),setTimeout(function(){e.isNavigating=!1},1)}}),n("rsvp/all",["rsvp/promise","exports"],function(e,t){function r(e){if(Object.prototype.toString.call(e)!=="[object Array]")throw new TypeError("You must pass an array to all.");return new n(function(t,n){function o(e){return function(t){u(e,t)}}function u(e,n){r[e]=n,--i===0&&t(r)}var r=[],i=e.length,s;i===0&&t([]);for(var a=0;a<e.length;a++)s=e[a],s&&typeof s.then=="function"?s.then(o(a),n):u(a,s)})}var n=e.Promise;t.all=r}),n("rsvp/async",["exports"],function(e){function i(){return function(){process.nextTick(a)}}function s(){var e=new n(a),t=document.createElement("div");return e.observe(t,{attributes:!0}),window.addEventListener("unload",function(){e.disconnect(),e=null},!1),function(){t.setAttribute("drainQueue","drainQueue")}}function o(){return function(){r.setTimeout(a,1)}}function a(){for(var e=0;e<u.length;e++){var t=u[e],n=t[0],r=t[1];n(r)}u=[]}function l(e,t){var n=u.push([e,t]);n===1&&f()}var t=typeof window!="undefined"?window:{},n=t.MutationObserver||t.WebKitMutationObserver,r=typeof global!="undefined"?global:this,u=[],f;typeof process!="undefined"&&{}.toString.call(process)==="[object process]"?f=i():n?f=s():f=o(),e.async=l}),n("rsvp/config",["rsvp/async","exports"],function(e,t){var n=e.async,r={};r.async=n,t.config=r}),n("rsvp/defer",["rsvp/promise","exports"],function(e,t){function r(){var e={resolve:undefined,reject:undefined,promise:undefined};return e.promise=new n(function(t,n){e.resolve=t,e.reject=n}),e}var n=e.Promise;t.defer=r}),n("rsvp/events",["exports"],function(e){var t=function(e,t){this.type=e;for(var n in t){if(!t.hasOwnProperty(n))continue;this[n]=t[n]}},n=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n][0]===t)return n;return-1},r=function(e){var t=e._promiseCallbacks;return t||(t=e._promiseCallbacks={}),t},i={mixin:function(e){return e.on=this.on,e.off=this.off,e.trigger=this.trigger,e},on:function(e,t,i){var s=r(this),o,u;e=e.split(/\s+/),i=i||this;while(u=e.shift())o=s[u],o||(o=s[u]=[]),n(o,t)===-1&&o.push([t,i])},off:function(e,t){var i=r(this),s,o,u;e=e.split(/\s+/);while(o=e.shift()){if(!t){i[o]=[];continue}s=i[o],u=n(s,t),u!==-1&&s.splice(u,1)}},trigger:function(e,n){var i=r(this),s,o,u,a,f;if(s=i[e])for(var l=0;l<s.length;l++)o=s[l],u=o[0],a=o[1],typeof n!="object"&&(n={detail:n}),f=new t(e,n),u.call(a,f)}};e.EventTarget=i}),n("rsvp/hash",["rsvp/defer","exports"],function(e,t){function r(e){var t=0;for(var n in e)t++;return t}function i(e){var t={},i=n(),s=r(e);s===0&&i.resolve({});var o=function(e){return function(t){u(e,t)}},u=function(e,n){t[e]=n,--s===0&&i.resolve(t)},a=function(e){i.reject(e)};for(var f in e)e[f]&&typeof e[f].then=="function"?e[f].then(o(f),a):u(f,e[f]);return i.promise}var n=e.defer;t.hash=i}),n("rsvp/node",["rsvp/promise","rsvp/all","exports"],function(e,t,n){function s(e,t){return function(n,r){n?t(n):arguments.length>2?e(Array.prototype.slice.call(arguments,1)):e(r)}}function o(e){return function(){var t=Array.prototype.slice.call(arguments),n,o,u=this,a=new r(function(e,t){n=e,o=t});return i(t).then(function(t){t.push(s(n,o));try{e.apply(u,t)}catch(r){o(r)}}),a}}var r=e.Promise,i=t.all;n.denodeify=o}),n("rsvp/promise",["rsvp/config","rsvp/events","exports"],function(e,t,n){function s(e){return o(e)||typeof e=="object"&&e!==null}function o(e){return typeof e=="function"}function a(e){r.onerror&&r.onerror(e.detail)}function l(e,t){e===t?h(e,t):c(e,t)||h(e,t)}function c(e,t){var n=null,r;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(s(t)){n=t.then;if(o(n))return n.call(t,function(n){if(r)return!0;r=!0,t!==n?l(e,n):h(e,n)},function(t){if(r)return!0;r=!0,p(e,t)}),!0}}catch(i){return p(e,i),!0}return!1}function h(e,t){r.async(function(){e.trigger("promise:resolved",{detail:t}),e.isFulfilled=!0,e.fulfillmentValue=t})}function p(e,t){r.async(function(){e.trigger("promise:failed",{detail:t}),e.isRejected=!0,e.rejectedReason=t})}var r=e.config,i=t.EventTarget,u=function(e){var t=this,n=!1;if(typeof e!="function")throw new TypeError("You must pass a resolver function as the sole argument to the promise constructor");if(!(t instanceof u))return new u(e);var r=function(e){if(n)return;n=!0,l(t,e)},i=function(e){if(n)return;n=!0,p(t,e)};this.on("promise:failed",function(e){this.trigger("error",{detail:e.detail})},this),this.on("error",a);try{e(r,i)}catch(s){i(s)}},f=function(e,t,n,r){var i=o(n),s,u,a,f;if(i)try{s=n(r.detail),a=!0}catch(h){f=!0,u=h}else s=r.detail,a=!0;if(c(t,s))return;i&&a?l(t,s):f?p(t,u):e==="resolve"?l(t,s):e==="reject"&&p(t,s)};u.prototype={constructor:u,isRejected:undefined,isFulfilled:undefined,rejectedReason:undefined,fulfillmentValue:undefined,then:function(e,t){this.off("error",a);var n=new this.constructor(function(){});return this.isFulfilled&&r.async(function(t){f("resolve",n,e,{detail:t.fulfillmentValue})},this),this.isRejected&&r.async(function(e){f("reject",n,t,{detail:e.rejectedReason})},this),this.on("promise:resolved",function(t){f("resolve",n,e,t)}),this.on("promise:failed",function(e){f("reject",n,t,e)}),n},fail:function(e){return this.then(null,e)}},i.mixin(u.prototype),n.Promise=u}),n("rsvp/reject",["rsvp/promise","exports"],function(e,t){function r(e){return new n(function(t,n){n(e)})}var n=e.Promise;t.reject=r}),n("rsvp/resolve",["rsvp/promise","exports"],function(e,t){function r(e){return new n(function(t,n){t(e)})}var n=e.Promise;t.resolve=r}),n("rsvp/rethrow",["exports"],function(e){function n(e){throw t.setTimeout(function(){throw e}),e}var t=typeof global=="undefined"?this:global;e.rethrow=n}),n("rsvp",["rsvp/events","rsvp/promise","rsvp/node","rsvp/all","rsvp/hash","rsvp/rethrow","rsvp/defer","rsvp/config","rsvp/resolve","rsvp/reject","exports"],function(e,t,n,r,i,s,o,u,a,f,l){function E(e,t){y[e]=t}var c=e.EventTarget,h=t.Promise,p=n.denodeify,d=r.all,v=i.hash,m=s.rethrow,g=o.defer,y=u.config,b=a.resolve,w=f.reject;l.Promise=h,l.EventTarget=c,l.all=d,l.hash=v,l.rethrow=m,l.defer=g,l.denodeify=p,l.configure=E,l.resolve=b,l.reject=w}),n("logger",[],function(){return console}),n("app/barcodescanner",["chui","rsvp","logger"],function(e,t,n){return function(){return e("article.current").addClass("blurred"),new t.Promise(function(t,r){n.debug("Launching barcode scanner"),cordova.plugins.barcodeScanner.scan(function(n){e("article.current").removeClass("blurred"),t(n.text)},function(t){e("article.current").removeClass("blurred"),r(t)})})}}),n("app/getBestPrice",["rsvp","logger"],function(e,t){var n=function(e){var t=0;for(var n in e.prices)e.prices.hasOwnProperty(n)&&t++;return t};return function(t){return new e.Promise(function(e,r){if(t&&t.trim().length>0){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState==4)if(i.status!=200)i.status===0&&/MacIntel/.test(navigator.platform)?setTimeout(function(){e({barcode:"8717418136771",prices:{WeBuyDVDs:{price:.25,details:{name:"WeBuyDVDs",url:"http://www.webuydvds.co.uk/"},title:""}},name:"New DVD",success:!0})},1e3):r(i.status+" ("+i.statusText+")");else{var o=JSON.parse(i.responseText);JSON.stringify(o.prices)==="{}"?(r("No matching items found for barcode "+o.barcode),analytics.trackEvent("getBestPrice","No Results",t)):(e(o),analytics.trackEvent("getBestPrice","Results",t+":"+n(o)+":"+o.name)),analytics.trackEvent("getBestPrice","ResponseTime",Date.now()-s+"")}};var s=Date.now();i.open("GET","http://price-app-checker-eu.herokuapp.com/?barcode="+t,!0),i.send()}else r("Invalid barcode")})}}),n("app/eventBus",["logger"],function(e){function n(e){return t[e]?t[e]:[]}var t={};return{subscribe:function(e,r){t[e]||(t[e]=[]),n(e).push(r)},unsubscribe:function(e,t){var r=n(e);for(var i=0,s=r.length;i<s;i++)if(r[i]===t){r.splice(i,1);return}},publish:function(t,r){var i=n(t);for(var s=0,o=i.length;s<o;s++)try{i[s](t,r)}catch(u){e.log(u),u.stack&&e.log(u.stack),analytics.trackEvent("Error",u,u.stack?u.stack:"no stack")}}}}),n("app/view/alertDialog",["chui","rsvp"],function(e,t){return function(n){return new t.Promise(function(t,r){analytics.trackView("Alert"),e.UIPopup({title:"An Error Occured",message:n,cancelButton:"OK",callback:function(){t()}})})}}),n("app/sendFeedback",["rsvp","logger"],function(e,t){return function(){var t=window.cordova.require("de.appplant.cordova.plugin.email-composer.EmailComposer");return new e.Promise(function(e,n){t.open({to:["makemecashapp@gmail.com"],subject:"Make Me Cash App Feedback",onSuccess:function(t){e(t)},onError:function(e){n(e)}})})}}),r.prototype.deviceIsAndroid=navigator.userAgent.indexOf("Android")>0,r.prototype.deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent),r.prototype.deviceIsIOS4=r.prototype.deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),r.prototype.deviceIsIOSWithBadTarget=r.prototype.deviceIsIOS&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent),r.prototype.needsClick=function(e){switch(e.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(e.disabled)return!0;break;case"input":if(this.deviceIsIOS&&e.type==="file"||e.disabled)return!0;break;case"label":case"video":return!0}return/\bneedsclick\b/.test(e.className)},r.prototype.needsFocus=function(e){switch(e.nodeName.toLowerCase()){case"textarea":case"select":return!0;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!e.disabled&&!e.readOnly;default:return/\bneedsfocus\b/.test(e.className)}},r.prototype.sendClick=function(e,t){var n,r;document.activeElement&&document.activeElement!==e&&document.activeElement.blur(),r=t.changedTouches[0],n=document.createEvent("MouseEvents"),n.initMouseEvent("click",!0,!0,window,1,r.screenX,r.screenY,r.clientX,r.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,e.dispatchEvent(n)},r.prototype.focus=function(e){var t;this.deviceIsIOS&&e.setSelectionRange?(t=e.value.length,e.setSelectionRange(t,t)):e.focus()},r.prototype.updateScrollParent=function(e){var t,n;t=e.fastClickScrollParent;if(!t||!t.contains(e)){n=e;do{if(n.scrollHeight>n.offsetHeight){t=n,e.fastClickScrollParent=n;break}n=n.parentElement}while(n)}t&&(t.fastClickLastScrollTop=t.scrollTop)},r.prototype.getTargetElementFromEventTarget=function(e){return e.nodeType===Node.TEXT_NODE?e.parentNode:e},r.prototype.onTouchStart=function(e){var t,n,r;if(e.targetTouches.length>1)return!0;t=this.getTargetElementFromEventTarget(e.target),n=e.targetTouches[0];if(this.deviceIsIOS){r=window.getSelection();if(r.rangeCount&&!r.isCollapsed)return!0;if(!this.deviceIsIOS4){if(n.identifier===this.lastTouchIdentifier)return e.preventDefault(),!1;this.lastTouchIdentifier=n.identifier,this.updateScrollParent(t)}}return this.trackingClick=!0,this.trackingClickStart=e.timeStamp,this.targetElement=t,this.touchStartX=n.pageX,this.touchStartY=n.pageY,e.timeStamp-this.lastClickTime<200&&e.preventDefault(),!0},r.prototype.touchHasMoved=function(e){var t=e.changedTouches[0],n=this.touchBoundary;return Math.abs(t.pageX-this.touchStartX)>n||Math.abs(t.pageY-this.touchStartY)>n?!0:!1},r.prototype.onTouchMove=function(e){if(!this.trackingClick)return!0;if(this.targetElement!==this.getTargetElementFromEventTarget(e.target)||this.touchHasMoved(e))this.trackingClick=!1,this.targetElement=null;return!0},r.prototype.findControl=function(e){return e.control!==undefined?e.control:e.htmlFor?document.getElementById(e.htmlFor):e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},r.prototype.onTouchEnd=function(e){var t,n,r,i,s,o=this.targetElement;if(!this.trackingClick)return!0;if(e.timeStamp-this.lastClickTime<200)return this.cancelNextClick=!0,!0;this.lastClickTime=e.timeStamp,n=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,this.deviceIsIOSWithBadTarget&&(s=e.changedTouches[0],o=document.elementFromPoint(s.pageX-window.pageXOffset,s.pageY-window.pageYOffset)||o,o.fastClickScrollParent=this.targetElement.fastClickScrollParent),r=o.tagName.toLowerCase();if(r==="label"){t=this.findControl(o);if(t){this.focus(o);if(this.deviceIsAndroid)return!1;o=t}}else if(this.needsFocus(o)){if(e.timeStamp-n>100||this.deviceIsIOS&&window.top!==window&&r==="input")return this.targetElement=null,!1;this.focus(o);if(!this.deviceIsIOS4||r!=="select")this.targetElement=null,e.preventDefault();return!1}if(this.deviceIsIOS&&!this.deviceIsIOS4){i=o.fastClickScrollParent;if(i&&i.fastClickLastScrollTop!==i.scrollTop)return!0}return this.needsClick(o)||(e.preventDefault(),this.sendClick(o,e)),!1},r.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},r.prototype.onMouse=function(e){return this.targetElement?e.forwardedTouchEvent?!0:e.cancelable?!this.needsClick(this.targetElement)||this.cancelNextClick?(e.stopImmediatePropagation?e.stopImmediatePropagation():e.propagationStopped=!0,e.stopPropagation(),e.preventDefault(),!1):!0:!0:!0},r.prototype.onClick=function(e){var t;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):e.target.type==="submit"&&e.detail===0?!0:(t=this.onMouse(e),t||(this.targetElement=null),t)},r.prototype.destroy=function(){var e=this.layer;this.deviceIsAndroid&&(e.removeEventListener("mouseover",this.onMouse,!0),e.removeEventListener("mousedown",this.onMouse,!0),e.removeEventListener("mouseup",this.onMouse,!0)),e.removeEventListener("click",this.onClick,!0),e.removeEventListener("touchstart",this.onTouchStart,!1),e.removeEventListener("touchmove",this.onTouchMove,!1),e.removeEventListener("touchend",this.onTouchEnd,!1),e.removeEventListener("touchcancel",this.onTouchCancel,!1)},r.notNeeded=function(e){var t;if(typeof window.ontouchstart=="undefined")return!0;if(/Chrome\/[0-9]+/.test(navigator.userAgent)){if(!r.prototype.deviceIsAndroid)return!0;t=document.querySelector("meta[name=viewport]");if(t&&t.content.indexOf("user-scalable=no")!==-1)return!0}return e.style.msTouchAction==="none"?!0:!1},r.attach=function(e){return new r(e)},typeof n!="undefined"&&n.amd?n("fastclick",[],function(){return r}):typeof module!="undefined"&&module.exports?(module.exports=r.attach,module.exports.FastClick=r):window.FastClick=r,t(["chui","app/barcodescanner","app/getBestPrice","app/eventBus","logger","app/view/alertDialog","app/sendFeedback","fastclick"],function(e,t,n,r,i,s,o,u){function a(){return e("#barcode").val()}function f(t){e("#barcode").val(t)}function l(){document.activeElement.blur()}function v(){c.on("click",function(e){analytics.trackEvent("Scanner","Launched"),t().then(function(e){analytics.trackEvent("Scanner","Closed",e),f(e)},function(e){s("An error occured whilst using the barcode scanner: "+e)})}),h.on("click",function(t){l();var i=a();r.publish("searchingForBarcode",{barcode:i}),analytics.trackEvent("getBestPrice","Launched",i),n(i).then(function(t){analytics.trackEvent("getBestPrice","Result",i),e.UINavigationHistory.pop(),f("&nbsp;"),r.publish("barcodeResult",t)},function(t){analytics.trackEvent("getBestPrice","NoResult",i);var n=s("Could not find a match for the barcode");e.UIGoBack()})});var i=function(e){l(),analytics.trackEvent("feedback","Launch"),o().then(function(){analytics.trackEvent("feedback","Sent")},function(){analytics.trackEvent("feedback","Cancelled")})};d.on("singletap",function(){return window.open(e(this).attr("href"),"_blank","location=yes"),!1}),e("#feedback").on("click",i),e("#feedback").on("singletap",i)}function m(){e.UIGoBack()}function g(){document.body.style.minHeight=window.innerHeight+"px",u.attach(document.body),v(),document.addEventListener("backbutton",m,!1);if(window.analytics)analytics.startTrackerWithId("UA-43287931-3"),analytics.trackView("App Launch");else{var t=function(){};window.analytics={trackView:t,trackEvent:t}}window.device&&parseFloat(window.device.version)>=7&&e("body").addClass("isiOSseven"),setTimeout(function(){window.navigator.splashscreen.hide()},1)}var c=e("#launch-scanner"),h=e("#find-the-best-price"),p=e("#feedback"),d=e("#search a");e.isAndroid&&p.removeClass("icon").html("Feedback"),document.addEventListener("deviceready",g,!1),window.cordova||setTimeout(g,1e3)}),n("app/view/barcodeForm",function(){}),n("app/dataStore",["rsvp"],function(e){function s(){return new e.Promise(function(e,t){var r=n.parse(localStorage.getItem("version"));r!==i&&localStorage.clear(),localStorage.setItem("version",n.stringify(i)),c().then(function(t){e(t)},function(e){t(e)})})}function o(e){e.undefined&&delete e.undefined;for(var t in e)e.hasOwnProperty(t)&&e[t].bestVendors.length===0&&delete e[t];return e}function u(e){var t=localStorage.getItem(e);t||(t="{}");try{return e==="pastResults"?o(n.parse(t)):n.parse(t)}catch(r){return{}}}function a(e){var t=u();return t[e]}function f(i,s){return new e.Promise(function(e,o){var a=u(t);a[i]=l(s),localStorage.setItem(t,n.stringify(a));var f=c(s);for(var h=0,p=r.length;h<p;h++)r[h](i,s);f.then(function(){e(s)})})}function l(e){var t=0,n=[];if(e){for(var r in e.prices){var i=e.prices[r].price;t<i?(t=i,n=[r]):t===i&&n.push(r)}e.bestVendors=n}return e}function c(){return new e.Promise(function(e,r){var i={},s=u(t);for(var o in s)for(var a in s[o].prices)i[a]||(i[a]={name:s[o].prices[a].details.name,url:s[o].prices[a].details.url,totalPrice:0}),i[a].totalPrice+=s[o].prices[a].price;localStorage.setItem("vendors",n.stringify(i)),e(i)})}function h(){return u("vendors")}var t="pastResults",n=JSON,r=[],i=1;return{saveResultToDisk:function(e){return f(e.barcode,e)},deletePastResult:function(e){f(e,undefined)},getPastResult:a,getPastResults:function(){return u(t)},getVendors:h,addUpdateListener:function(e){r.push(e)},init:s}}),n("app/priceResultManager",["app/dataStore","app/eventBus"],function(e,t){function n(){t.publish("priceResultRepoChange",o)}function r(t,r){try{r.name=r.WeBuyDVDs.title}catch(i){}e.saveResultToDisk(r).then(n)}function i(){var t=e.getPastResults(),n=0;try{for(var r in t)if(t.hasOwnProperty(r)){var i=0,s=t[r];n+=s.prices[s.bestVendors[0]].price}}catch(o){}return n}function s(){return e.getVendors()}t.subscribe("barcodeResult",r);var o={getTotalBestPrice:i,getAllResults:function(){return e.getPastResults()},getVendors:s,deleteItem:function(t){e.deletePastResult(t)}};return e.init().then(n),o}),n("app/view/tabbar",["chui","app/eventBus","app/priceResultManager"],function(e,t,n){function s(t,n){e(".tabbar .best-price label").html("Best Price"+i+"£"+n.getTotalBestPrice().toFixed(2))}var r={tabs:3,icons:["search","best-price","by-vendor"],labels:["Search","Best Price","By Vendor"],selected:1};e.UITabbar(r);var i=e.isAndroid?"&nbsp;":"<br/>";t.subscribe("priceResultRepoChange",s),s("priceResultRepoChange",n)}),n("text",["module"],function(e){var n,r,i,s,o,u=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],a=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,f=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,l=typeof location!="undefined"&&location.href,c=l&&location.protocol&&location.protocol.replace(/\:/,""),h=l&&location.hostname,p=l&&(location.port||undefined),d={},v=e.config&&e.config()||{};n={version:"2.0.10",strip:function(e){if(e){e=e.replace(a,"");var t=e.match(f);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:v.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=u[t];try{e=new ActiveXObject(n)}catch(r){}if(e){u=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,r,i){var s,o,u,a=n.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===t)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,t,r,i){r=t?n.strip(r):r,v.isBuild&&(d[e]=r),i(r)},load:function(e,t,r,i){if(i.isBuild&&!i.inlineText){r();return}v.isBuild=i.isBuild;var s=n.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=t.toUrl(o),a=v.useXhr||n.useXhr;if(u.indexOf("empty:")===0){r();return}!l||a(u,c,h,p)?n.get(u,function(t){n.finishLoad(e,s.strip,t,r)},function(e){r.error&&r.error(e)}):t([o],function(e){n.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,t,r,i){if(d.hasOwnProperty(t)){var s=n.jsEscape(d[t]);r.asModule(e+"!"+t,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,t,r,i,s){var o=n.parseName(t),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";n.load(a,r,function(t){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},n.write(e,a,r,s)},s)}};if(v.env==="node"||!v.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"])r=t.nodeRequire("fs"),n.get=function(e,t,n){try{var i=r.readFileSync(e,"utf8");i.indexOf("﻿")===0&&(i=i.substring(1)),t(i)}catch(s){n(s)}};else if(v.env==="xhr"||!v.env&&n.createXhr())n.get=function(e,t,r,i){var s=n.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);v.onXhr&&v.onXhr(s,e),s.onreadystatechange=function(n){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):t(s.responseText),v.onXhrComplete&&v.onXhrComplete(s,e))},s.send(null)};else if(v.env==="rhino"||!v.env&&typeof Packages!="undefined"&&typeof java!="undefined")n.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(v.env==="xpconnect"||!v.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)i=Components.classes,s=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),o="@mozilla.org/windows-registry-key;1"in i,n.get=function(e,t){var n,r,u,a={};o&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=i["@mozilla.org/network/file-input-stream;1"].createInstance(s.nsIFileInputStream),n.init(u,1,0,!1),r=i["@mozilla.org/intl/converter-input-stream;1"].createInstance(s.nsIConverterInputStream),r.init(n,"utf-8",n.available(),s.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),r.readString(n.available(),a),r.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return n}),n("text!app/view/tmpl/singleResult.tmpl",[],function(){return"<section>\n    <h3>[[= data.name]]</h3>\n    <ul class='list' >\n        [[ for (var res in data.prices) { ]]\n        <li>\n            <h3>[[= res]]</h3>\n            <h3>£[[= data.prices[res].price.toFixed(2)]]</h3>\n        </li>\n        [[ } ]]\n    </ul>\n    <p>These prices may change by the vendors on subsequent scans</p>\n</section>"}),n("text!app/view/tmpl/searching.tmpl",[],function(){return'<section>\n    <h3>[[= data.barcode]]</h3>\n    <div class="carousel">\n        <div class="cell"><img src="img/logos/musicmagpie_no_bird.png"/></div>\n        <div class="cell"><img src="img/logos/zapper.png"/></div>\n        <div class="cell"><img src="img/logos/zumu.png"/></div>\n        <div class="cell"><img src="img/logos/cex.png"/></div>\n        <div class="mag-glass"><span class="glyphicon glyphicon-search"></span></div>\n    </div>\n</section>'}),n("app/view/singleResult",["chui","app/eventBus","text!app/view/tmpl/singleResult.tmpl","text!app/view/tmpl/searching.tmpl"],function(e,t,n,r){function i(t,r){e("#results").html(n(r)),e.UIGoToArticle("#results"),analytics.trackEvent("singleResult","Show",r.barcode)}function s(t,n){e("#searching").html(r(n)),e.UIGoToArticle("#searching")}n=e.template(n),t.subscribe("barcodeResult",i),r=e.template(r),t.subscribe("searchingForBarcode",s)}),n("text!app/view/tmpl/bestPriceForAllVendors.tmpl",[],function(){return'<section>\n    <h3><span>You could make</span>£[[= data.totalPrice.toFixed(2)]]</h3>\n    <ul class=\'list\' >\n        [[ for (var item in data.results) {\n                if (data.results.hasOwnProperty(item) && data.results[item].bestVendors.length >= 1) {\n                    var bestVendor = data.results[item].bestVendors[0]; ]]\n        <li class="comp" data-barcode="[[= item]]">\n            <div>\n                <h3>[[= data.results[item].prices[bestVendor].title || data.results[item].name]]</h3>\n                <h4>[[= bestVendor]]</h4>\n            </div>\n            <aside>\n                <h4>£[[= data.results[item].prices[bestVendor].price.toFixed(2)]]</h4>\n                <span class="nav"></span>\n            </aside>\n        </li>\n        [[\n                }\n            } ]]\n    </ul>\n    <p>These prices may change by the vendors on subsequent scans</p>\n</section>'}),n("app/view/bestPrice",["chui","app/eventBus","app/priceResultManager","text!app/view/tmpl/bestPriceForAllVendors.tmpl"],function(e,t,n,r){function s(r){var r=e(r).parent("li"),s=r.dataset("barcode");analytics.trackEvent("bestPrice","Delete",s),n.deleteItem(s);var o=n.getTotalBestPrice(),u=e("#bestprice section > h3"),a=u.text().split("£")[1];u.html(u.html().replace(a,o.toFixed(2))),i=!0,t.publish("priceResultRepoChange",n),i=!1}function o(){if(!i){var t={results:n.getAllResults(),totalPrice:n.getTotalBestPrice()};e("#bestprice").html(r(t)),e.UIDeletable({list:"#bestprice ul",callback:s})}}function u(r){if(e(arguments[0].target).hasClass("deletion-indicator").length===0&&e(arguments[0].target).hasClass("delete").length===0){var i=e(arguments[0].target).ancestor("li"),s=i.dataset("barcode");if(s){analytics.trackEvent("bestPrice","Show",s);var o=n.getAllResults()[s];t.publish("barcodeResult",o)}}}r=e.template(r);var i=!1;e("#bestprice").on("singletap",u),t.subscribe("priceResultRepoChange",o),o()}),n("text!app/view/tmpl/byVendor.tmpl",[],function(){return'[[ for (var vendor in data.vendors) {\n        if (data.vendors.hasOwnProperty(vendor)) {\n        ]]\n    <section class="next">\n        <h3>[[= vendor]]: <span>£[[= data.vendors[vendor].totalPrice.toFixed(2)]]</span></h3>\n        <ul class=\'list\' >\n            [[ for (var item in data.results) {\n                if (data.results.hasOwnProperty(item) && data.results[item].prices[vendor]) {\n                    ]]\n            <li class="comp">\n                <div>\n                    <h3>[[= data.results[item].prices[vendor].title || data.results[item].name]]</h3>\n                </div>\n                <aside>\n                    <h4>£[[= data.results[item].prices[vendor].price.toFixed(2)]]</h4>\n                </aside>\n            </li>\n            [[\n                    }\n                } ]]\n        </ul>\n        <p>These prices may change by the vendors on subsequent scans</p>\n    </section>\n[[      }\n    } ]]'}),n("app/view/byVendor",["chui","app/eventBus","app/priceResultManager","text!app/view/tmpl/byVendor.tmpl"],function(e,t,n,r){function i(){var t={results:n.getAllResults(),vendors:n.getVendors()};e("#byvendor").html(r(t)),e("#byvendor > section:first-child").removeClass("next").addClass("current")}r=e.template(r),t.subscribe("priceResultRepoChange",i),e.UIPaging()}),t(["app/UIPagingPatch","app/view/barcodeForm","app/view/tabbar","app/view/singleResult","app/priceResultManager","app/view/bestPrice","app/view/byVendor"]),n("priceCheckerApp.js",function(){})})();